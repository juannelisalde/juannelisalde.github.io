const a0_0x671da7=a0_0x3929;(function(_0x10f438,_0x43855a){const _0xd049b7=a0_0x3929,_0x5c5ca8=_0x10f438();while(!![]){try{const _0x4ebf74=parseInt(_0xd049b7(0x89))/0x1*(parseInt(_0xd049b7(0xb4))/0x2)+parseInt(_0xd049b7(0xa9))/0x3*(-parseInt(_0xd049b7(0xcb))/0x4)+parseInt(_0xd049b7(0xae))/0x5+parseInt(_0xd049b7(0xa8))/0x6+-parseInt(_0xd049b7(0x93))/0x7*(-parseInt(_0xd049b7(0x8a))/0x8)+-parseInt(_0xd049b7(0xc5))/0x9*(parseInt(_0xd049b7(0xc0))/0xa)+parseInt(_0xd049b7(0xd9))/0xb;if(_0x4ebf74===_0x43855a)break;else _0x5c5ca8['push'](_0x5c5ca8['shift']());}catch(_0xa17292){_0x5c5ca8['push'](_0x5c5ca8['shift']());}}}(a0_0x54e2,0x5ced6));const hostLogin=a0_0x671da7(0xd1),dataLogin={'oidUsuario':0x1,'oidCentroAtencion':0x1},hostDocument='https://citas.usiese.gov.co:6007/api/Generales/ApiGeReporteGenerado/ExportarReporte',hostFolio=a0_0x671da7(0x8b);let allData=[];const noPrintEspecialidad=['ODONTOLOGIA\x20GENERAL'],noPrintDiagnostico=['CARIES\x20DE\x20LA\x20DENTINA'],noImprimir=[a0_0x671da7(0xd7),a0_0x671da7(0xa7),a0_0x671da7(0xc8)],showSpinner=()=>{const _0x2a97be=a0_0x671da7;$(_0x2a97be(0xb9))['removeClass'](_0x2a97be(0x96));},hideSpinner=()=>{const _0x4333d9=a0_0x671da7;$(_0x4333d9(0xb9))[_0x4333d9(0x85)]('d-none');};function a0_0x3929(_0x474502,_0x4a26c2){const _0x54e2f7=a0_0x54e2();return a0_0x3929=function(_0x392950,_0x24eb82){_0x392950=_0x392950-0x79;let _0x49b7b7=_0x54e2f7[_0x392950];return _0x49b7b7;},a0_0x3929(_0x474502,_0x4a26c2);}function a0_0x54e2(){const _0xdc4f17=['preventDefault','CONSULTA\x20EXTERNA','map','973544feUgxp','#dates','padStart','all','#documents','onload','Error\x20al\x20procesar\x20los\x20documentos:','val','download','<p>','target','setItem','#resultContainerDownloadDates','appendChild','removeChild','No\x20hay\x20datos\x20para\x20descargar.','addClass','token','sheet_to_json','normalize','23mzEcBu','1866584DdQWXN','https://citas.usiese.gov.co:6007/api/HistoriaClinica/HistoriaClinicaConsulta/ObtenerHistoricoFolios/?oidIngreso=0&directivas=true&hcUnificada=false&id=','includes','</p>','getUTCFullYear','visibility','#resultContainerFormatDates','body','NFD','21XrmZvK','Bearer\x20','error','d-none','Sheets','String','split','array','Resultado.csv','application/json','input','createElement','result','.csv','getItem','test','Error\x20al\x20obtener\x20el\x20documento:','POST','toUpperCase','read','URGENCIAS','2601372myRJhH','15WuvygS','trim','<p><b>PACNUMDOC;\x20NOMBRE;\x20SEXO;\x20EDAD_ACTUAL;\x20EDAD_SERVICIO;\x20SIPCODIGO;\x20SIPNOMBRE;\x20SERFECSER</b></p>','forEach','style','1430210RAThHL','Activo','text/csv;charset=utf-8;','getUTCDate','href','replace','982PoEMKw','push','</br>','No\x20se\x20encontraron\x20documentos\x20válidos.','stringify','#spinner','utils','SheetNames','length','SERVICIOS\x20PRESTADOS\x20A\x20PACIENTES','append','join','1076050AAFuaQ','setAttribute','empty','click','submit','45JtjIpN','#formFormatDates','@DOCUMENTO','TRIAGE','createObjectURL','each','480572UpInmW','Error\x20al\x20obtener\x20el\x20token:','blob','GET',';\x20sin\x20citas</p>','GENPACIEN.PACNUMDOC\x20=','https://citas.usiese.gov.co:6007/api/Generales/ApiGeSeguridad/IniciarSesionCentroAtencion','ajax','filter','DOCUMENTO','children'];a0_0x54e2=function(){return _0xdc4f17;};return a0_0x54e2();}$(a0_0x671da7(0x79))['on'](a0_0x671da7(0x9d),function(){const _0x52027a=a0_0x671da7,_0x384857=/^[0-9,\s]*$/;let _0x26cbbd=$(this)[_0x52027a(0x7c)]();_0x26cbbd=_0x26cbbd[_0x52027a(0xb3)](/[\n\r]+/g,','),!_0x384857[_0x52027a(0xa2)](_0x26cbbd)&&(_0x26cbbd=_0x26cbbd[_0x52027a(0xb3)](/[^0-9,\s,]/g,'')),$(this)[_0x52027a(0x7c)](_0x26cbbd);}),$('#formDownloadDates')['on']('submit',async function(_0x2774bc){const _0x1b4711=a0_0x671da7;_0x2774bc[_0x1b4711(0xd6)](),$(_0x1b4711(0x81))[_0x1b4711(0xc2)](),allData=[];let _0x384f84=$(_0x1b4711(0x79))[_0x1b4711(0x7c)]()[_0x1b4711(0x99)](',');_0x384f84=_0x384f84[_0x1b4711(0xd8)](_0x19627f=>_0x19627f['trim']()),_0x384f84['sort']((_0x66cc8d,_0x1133c1)=>_0x66cc8d-_0x1133c1),_0x384f84=[...new Set(_0x384f84)],_0x384f84=_0x384f84[_0x1b4711(0xd3)](_0x22d686=>_0x22d686!==''&&_0x22d686['length']>0x0);if(_0x384f84[_0x1b4711(0xbc)]===0x0){alert(_0x1b4711(0xb7));return;}showSpinner();try{await Promise[_0x1b4711(0xdc)](_0x384f84[_0x1b4711(0xd8)](_0x353e06=>getDocument(_0x353e06))),hideSpinner();}catch(_0x4a2798){console[_0x1b4711(0x95)](_0x1b4711(0x7b),_0x4a2798),hideSpinner();}}),$('#downloadCSV')['on']('click',function(){const _0x2775c2=a0_0x671da7;if($(_0x2775c2(0x81))[_0x2775c2(0xd5)]()['length']===0x0){alert(_0x2775c2(0x84));return;}exportResultContainerToCSV(_0x2775c2(0x9b));});const getToken=()=>{const _0xc5abc7=a0_0x671da7;if(localStorage[_0xc5abc7(0xa1)](_0xc5abc7(0x86)))return localStorage['getItem'](_0xc5abc7(0x86));$[_0xc5abc7(0xd2)]({'url':hostLogin,'type':_0xc5abc7(0xa4),'contentType':_0xc5abc7(0x9c),'data':JSON[_0xc5abc7(0xb8)](dataLogin),'success':function(_0x38f297){const _0x4707b1=_0xc5abc7,_0x3e8b24=_0x38f297['token'];return localStorage[_0x4707b1(0x80)](_0x4707b1(0x86),_0x3e8b24),_0x3e8b24;},'error':function(_0x1c2fe2){const _0x56fa5d=_0xc5abc7;return console[_0x56fa5d(0x95)](_0x56fa5d(0xcc),_0x1c2fe2),null;}});},getParams=_0x24cd3c=>{const _0x266e58=a0_0x671da7;return encodeURIComponent(JSON[_0x266e58(0xb8)]({'Nombre':_0x266e58(0xbd),'Descripcion':_0x266e58(0xbd),'SentenciaSQL':'','Estado':_0x266e58(0xaf),'Parametros':[{'Nombre':'DOCUMENTO','Campo':_0x266e58(0xd0),'Tipo':'String','DbNombre':_0x266e58(0xd4),'DbNombreCompleto':_0x266e58(0xc7),'DbTamano':0x1e,'DbTipo':_0x266e58(0x98),'Valor':_0x24cd3c,'Oid':0x1,'IdBloqueo':null,'RegistroEliminado':![],'OidResult':null}],'formato':'XLSX\x20PLANO','SerializadoXml':!![],'Oid':0x1a,'IdBloqueo':null,'RegistroEliminado':![],'OidResult':null}));},readExcelFromBlob=_0x3ec9b2=>{const _0xd19e1a=a0_0x671da7,_0x241e21=new FileReader();_0x241e21[_0xd19e1a(0x7a)]=function(_0x588110){const _0xd96b01=_0xd19e1a,_0x30cfb5=new Uint8Array(_0x588110[_0xd96b01(0x7f)]['result']),_0x20a543=XLSX[_0xd96b01(0xa6)](_0x30cfb5,{'type':_0xd96b01(0x9a)}),_0x1ccd92=_0x20a543['SheetNames'][0x0],_0x1b09e1=_0x20a543[_0xd96b01(0x97)][_0x1ccd92],_0x435cfa=XLSX[_0xd96b01(0xba)][_0xd96b01(0x87)](_0x1b09e1,{'header':0x1});_0x435cfa[_0xd96b01(0xac)]((_0xf60226,_0x3affae)=>{const _0x123b18=_0xd96b01;if(_0x3affae>0x0){let _0x3e3c63=_0xf60226[0x1],_0x2f9397=_0xf60226[0x2]+'\x20'+_0xf60226[0x3]+'\x20'+_0xf60226[0x4]+'\x20'+_0xf60226[0x5],_0x46e1b1=_0xf60226[0x6],_0x1c9f7a=_0xf60226[0x8],_0x27f443=_0xf60226[0x9],_0x5e7530=_0xf60226[0x14],_0x584fbe=_0xf60226[0x15],_0x2b7ed2=excelDateToJSDate(_0xf60226[0x1e]);$(_0x123b18(0x81))[_0x123b18(0xbe)](_0x123b18(0x7e)+_0x3e3c63+',\x20'+_0x2f9397+',\x20'+_0x46e1b1+',\x20'+_0x1c9f7a+',\x20'+_0x27f443+',\x20'+_0x5e7530+',\x20'+_0x584fbe+',\x20'+excelDateToJSDate(_0x2b7ed2)+'</p>');}});},_0x241e21['readAsArrayBuffer'](_0x3ec9b2);},excelDateToJSDate=_0x21131e=>{const _0x9af28=a0_0x671da7,_0x1d631e=_0x21131e-0x63e1,_0x99ee5e=_0x1d631e*0x15180,_0x436aef=new Date(_0x99ee5e*0x3e8),_0x18a9ae=String(_0x436aef[_0x9af28(0xb1)]())[_0x9af28(0xdb)](0x2,'0'),_0x2bbaa4=String(_0x436aef['getUTCMonth']()+0x1)[_0x9af28(0xdb)](0x2,'0'),_0x119994=_0x436aef[_0x9af28(0x8e)]();return _0x18a9ae+'/'+_0x2bbaa4+'/'+_0x119994;},getDocument=_0x3f386c=>{const _0x1db537=a0_0x671da7;return $('#resultContainerDownloadDates')[_0x1db537(0xd5)]()['length']===0x0&&$(_0x1db537(0x81))[_0x1db537(0xbe)](_0x1db537(0xab)),new Promise(_0x5125c0=>{const _0xdb34f=_0x1db537;$[_0xdb34f(0xd2)]({'url':hostDocument,'type':_0xdb34f(0xce),'headers':{'repparams':getParams(_0x3f386c),'Authorization':_0xdb34f(0x94)+getToken()},'xhrFields':{'responseType':_0xdb34f(0xcd)},'success':function(_0x436ea9){const _0x5cafe5=new FileReader();_0x5cafe5['onload']=function(_0x2696ef){const _0x1f8a78=a0_0x3929,_0x303785=new Uint8Array(_0x2696ef[_0x1f8a78(0x7f)][_0x1f8a78(0x9f)]),_0x22be24=XLSX[_0x1f8a78(0xa6)](_0x303785,{'type':_0x1f8a78(0x9a)}),_0x27a5be=_0x22be24[_0x1f8a78(0xbb)][0x0],_0x49cb18=_0x22be24[_0x1f8a78(0x97)][_0x27a5be],_0x4e16d4=XLSX[_0x1f8a78(0xba)][_0x1f8a78(0x87)](_0x49cb18,{'header':0x1});let _0x20b94f=![],_0x52b4e7=[];_0x4e16d4[_0x1f8a78(0xac)]((_0x44e927,_0x49a1c4)=>{const _0xf858f8=_0x1f8a78;if(_0x49a1c4>0x0){const _0x551609=_0x44e927[0x1],_0x3583a3=replaceAccents(_0x44e927[0x2]+'\x20'+_0x44e927[0x3]+'\x20'+_0x44e927[0x4]+'\x20'+_0x44e927[0x5]),_0x46e22b=_0x44e927[0x6],_0x5ad857=replaceAccents(_0x44e927[0x8]),_0x4c8441=replaceAccents(_0x44e927[0x9]),_0x10d0f7=_0x44e927[0x14],_0x55f699=replaceAccents(_0x44e927[0x15]),_0x3cdba0=excelDateToJSDate(_0x44e927[0x1e]);if(noImprimir['some'](_0x32e8d6=>_0x55f699[_0xf858f8(0x8c)](_0x32e8d6[_0xf858f8(0xa5)]())))return;if(!_0x551609){$(_0xf858f8(0x81))[_0xf858f8(0xbe)](_0xf858f8(0x7e)+_0x3f386c+_0xf858f8(0xcf)),_0x20b94f=!![];return;}!_0x52b4e7[_0xf858f8(0x8c)](_0x10d0f7)&&$(_0xf858f8(0x81))[_0xf858f8(0xbe)]('<p>'+_0x551609+';\x20'+_0x3583a3+';\x20'+_0x46e22b+';\x20'+_0x5ad857+';\x20'+_0x4c8441+';\x20'+_0x10d0f7+';\x20'+_0x55f699+';\x20'+_0x3cdba0+_0xf858f8(0x8d)),_0x52b4e7[_0xf858f8(0xb5)](_0x10d0f7),_0x20b94f=!![];}}),!_0x20b94f&&$(_0x1f8a78(0x81))[_0x1f8a78(0xbe)]('<p>'+_0x3f386c+';\x20sin\x20PM</p>');},_0x5cafe5['readAsArrayBuffer'](_0x436ea9),_0x5125c0();},'error':function(_0x35479a){const _0x212012=_0xdb34f;console[_0x212012(0x95)](_0x212012(0xa3),_0x35479a),_0x5125c0();}});});},exportResultContainerToCSV=_0xce93cb=>{const _0x2e3128=a0_0x671da7,_0x3c5006=[];$(_0x2e3128(0x81))['children']()[_0x2e3128(0xca)](function(){const _0x5306bc=_0x2e3128,_0x4f5065=$(this)['text']()['trim']();_0x4f5065&&_0x3c5006[_0x5306bc(0xb5)](_0x4f5065);});const _0x28f885=_0x3c5006[_0x2e3128(0xbf)]('\x0a'),_0xb38832=new Blob([_0x28f885],{'type':_0x2e3128(0xb0)}),_0x16de0a=document[_0x2e3128(0x9e)]('a'),_0x1503d7=URL[_0x2e3128(0xc9)](_0xb38832);_0x16de0a[_0x2e3128(0xc1)](_0x2e3128(0xb2),_0x1503d7),_0x16de0a[_0x2e3128(0xc1)](_0x2e3128(0x7d),_0xce93cb+_0x2e3128(0xa0)),_0x16de0a[_0x2e3128(0xad)][_0x2e3128(0x8f)]='hidden',document['body'][_0x2e3128(0x82)](_0x16de0a),_0x16de0a[_0x2e3128(0xc3)](),document[_0x2e3128(0x91)][_0x2e3128(0x83)](_0x16de0a);},replaceAccents=_0x20e29d=>{const _0x2a7df0=a0_0x671da7;if(!_0x20e29d)return'';return _0x20e29d[_0x2a7df0(0x88)](_0x2a7df0(0x92))[_0x2a7df0(0xb3)](/[\u0300-\u036f]/g,'');};$('#formFormatDates')['on'](a0_0x671da7(0xc4),async function(_0x2843f3){const _0x4174aa=a0_0x671da7;_0x2843f3[_0x4174aa(0xd6)](),showSpinner(),$(_0x4174aa(0x90))[_0x4174aa(0xc2)](),dates[_0x4174aa(0xd8)](_0x3fecc0=>{const _0x525db1=_0x4174aa,_0x1bbd3c=_0x3fecc0['split']('/');if(_0x1bbd3c['length']!==0x3)return'Fecha\x20inválida';let [_0x2ae61a,_0xd9ee5,_0x280b03]=_0x1bbd3c[_0x525db1(0xd8)](_0x506dd6=>parseInt(_0x506dd6,0xa));if(_0x2ae61a>0xc)return String(_0x2ae61a)[_0x525db1(0xdb)](0x2,'0')+'/'+String(_0xd9ee5)[_0x525db1(0xdb)](0x2,'0')+'/'+_0x280b03;return String(_0xd9ee5)[_0x525db1(0xdb)](0x2,'0')+'/'+String(_0x2ae61a)[_0x525db1(0xdb)](0x2,'0')+'/'+_0x280b03;}),hideSpinner();});const processDates=_0x5011e8=>{const _0x50516a=a0_0x671da7;return _0x5011e8[_0x50516a(0xd8)](_0x3fd836=>{const _0x623e47=_0x50516a,_0x34f1b1=_0x3fd836[_0x623e47(0x99)]('/');if(_0x34f1b1[_0x623e47(0xbc)]!==0x3)return'Fecha\x20inválida';let [_0x103bf4,_0x3dfa5b,_0x454678]=_0x34f1b1[_0x623e47(0xd8)](_0x5a01d3=>parseInt(_0x5a01d3,0xa));if(_0x103bf4>0xc)return String(_0x103bf4)[_0x623e47(0xdb)](0x2)+'/'+String(_0x3dfa5b)['padStart'](0x2)+'/'+_0x454678;return String(_0x3dfa5b)[_0x623e47(0xdb)](0x2)+'/'+String(_0x103bf4)[_0x623e47(0xdb)](0x2)+'/'+_0x454678;});};$(a0_0x671da7(0xc6))['on']('submit',async function(_0x2d7910){const _0x463a54=a0_0x671da7;_0x2d7910['preventDefault'](),showSpinner(),$(_0x463a54(0x90))['empty']();let _0x3dd83f=$(_0x463a54(0xda))[_0x463a54(0x7c)]()[_0x463a54(0xb3)](/[\n\r]+/g,',')[_0x463a54(0x99)](',');_0x3dd83f=_0x3dd83f[_0x463a54(0xd8)](_0x286875=>_0x286875[_0x463a54(0xaa)]()),_0x3dd83f=_0x3dd83f[_0x463a54(0xd3)](_0x3e050b=>_0x3e050b!=='');const _0x416b4c=processDates(_0x3dd83f);_0x416b4c[_0x463a54(0xac)](_0x50f737=>{const _0x3ce637=_0x463a54;$(_0x3ce637(0x90))['append'](_0x50f737+_0x3ce637(0xb6));}),hideSpinner();});