const a0_0x3e9f98=a0_0x4437;function a0_0x4437(_0x2f8caa,_0x4bdaa2){const _0x373fbc=a0_0x373f();return a0_0x4437=function(_0x4437a6,_0xf844b5){_0x4437a6=_0x4437a6-0xbb;let _0x50e456=_0x373fbc[_0x4437a6];return _0x50e456;},a0_0x4437(_0x2f8caa,_0x4bdaa2);}(function(_0x191c54,_0x56589c){const _0x2ea54e=a0_0x4437,_0x1af3dd=_0x191c54();while(!![]){try{const _0x2a4f4d=-parseInt(_0x2ea54e(0x119))/0x1*(-parseInt(_0x2ea54e(0xda))/0x2)+-parseInt(_0x2ea54e(0x101))/0x3+parseInt(_0x2ea54e(0xc0))/0x4*(-parseInt(_0x2ea54e(0xc2))/0x5)+-parseInt(_0x2ea54e(0xcd))/0x6+-parseInt(_0x2ea54e(0xf6))/0x7+-parseInt(_0x2ea54e(0x117))/0x8*(parseInt(_0x2ea54e(0xf3))/0x9)+parseInt(_0x2ea54e(0xe5))/0xa;if(_0x2a4f4d===_0x56589c)break;else _0x1af3dd['push'](_0x1af3dd['shift']());}catch(_0x552ebe){_0x1af3dd['push'](_0x1af3dd['shift']());}}}(a0_0x373f,0x90764));const hostLogin=a0_0x3e9f98(0x10a),dataLogin={'oidUsuario':0x1,'oidCentroAtencion':0x1},hostDocument=a0_0x3e9f98(0x112),hostFolio='https://citas.usiese.gov.co:6007/api/HistoriaClinica/HistoriaClinicaConsulta/ObtenerHistoricoFolios/?oidIngreso=0&directivas=true&hcUnificada=false&id=';function a0_0x373f(){const _0x3051cc=['</p>','Error\x20al\x20obtener\x20el\x20token:','removeChild','getUTCDate','<p><b>PACNUMDOC;\x20NOMBRE;\x20SEXO;\x20EDAD_ACTUAL;\x20EDAD_SERVICIO;\x20SIPCODIGO;\x20SIPNOMBRE;\x20SERFECSER</b></p>','#downloadCSV','token','createObjectURL','Resultado.csv','setItem','11584020QGNHfo','getItem','removeClass','toUpperCase','each','GENPACIEN.PACNUMDOC\x20=','test','body','CARIES\x20DE\x20LA\x20DENTINA','val','sort','sheet_to_json','append',';\x20sin\x20PM</p>','3725217hGmJDg','NFD','replace','2254406cePFIF','<p>','padStart','empty','submit','text','Bearer\x20','forEach','target','blob','error','839460JwFisx','getUTCFullYear','#formDocuments','setAttribute','readAsArrayBuffer','stringify','No\x20se\x20encontraron\x20documentos\x20vÃ¡lidos.','CONSULTA\x20EXTERNA','normalize','https://citas.usiese.gov.co:6007/api/Generales/ApiGeSeguridad/IniciarSesionCentroAtencion','children','some','@DOCUMENTO','length','.csv','createElement','DOCUMENTO','https://citas.usiese.gov.co:6007/api/Generales/ApiGeReporteGenerado/ExportarReporte','read','String','GET','result','8tnuzex','array','17zIfSIK','SERVICIOS\x20PRESTADOS\x20A\x20PACIENTES','trim','ODONTOLOGIA\x20GENERAL','push','click','15164swtbGf','onload','265qLbJOe','Error\x20al\x20obtener\x20el\x20documento:','href','includes','Sheets','POST','Error\x20al\x20procesar\x20los\x20documentos:','hidden','d-none','appendChild','map','309474MyQgKl','#spinner','TRIAGE','style','XLSX\x20PLANO','#resultContainer','utils','Activo','text/csv;charset=utf-8;','#documents','visibility','SheetNames','preventDefault','82542CTMMxT'];a0_0x373f=function(){return _0x3051cc;};return a0_0x373f();}let allData=[];const noPrintEspecialidad=[a0_0x3e9f98(0xbd)],noPrintDiagnostico=[a0_0x3e9f98(0xed)],noImprimir=[a0_0x3e9f98(0x108),'URGENCIAS',a0_0x3e9f98(0xcf)],showSpinner=()=>{const _0x35c80b=a0_0x3e9f98;$(_0x35c80b(0xce))[_0x35c80b(0xe7)](_0x35c80b(0xca));},hideSpinner=()=>{const _0x180e15=a0_0x3e9f98;$('#spinner')['addClass'](_0x180e15(0xca));};$(a0_0x3e9f98(0xd6))['on']('input',function(){const _0x3d611c=a0_0x3e9f98,_0x2400dd=/^[0-9,\s]*$/;let _0x55a72c=$(this)[_0x3d611c(0xee)]();_0x55a72c=_0x55a72c[_0x3d611c(0xf5)](/[\n\r]+/g,','),!_0x2400dd[_0x3d611c(0xeb)](_0x55a72c)&&(_0x55a72c=_0x55a72c['replace'](/[^0-9,\s,]/g,'')),$(this)[_0x3d611c(0xee)](_0x55a72c);}),$(a0_0x3e9f98(0x103))['on'](a0_0x3e9f98(0xfa),async function(_0x49f0c5){const _0x35e1a8=a0_0x3e9f98;_0x49f0c5[_0x35e1a8(0xd9)](),$(_0x35e1a8(0xd2))[_0x35e1a8(0xf9)](),allData=[];let _0x493480=$(_0x35e1a8(0xd6))['val']()['split'](',');_0x493480=_0x493480[_0x35e1a8(0xcc)](_0x35db98=>_0x35db98[_0x35e1a8(0xbc)]()),_0x493480[_0x35e1a8(0xef)]((_0xae6643,_0x368651)=>_0xae6643-_0x368651),_0x493480=[...new Set(_0x493480)],_0x493480=_0x493480['filter'](_0xc0cb3c=>_0xc0cb3c!==''&&_0xc0cb3c[_0x35e1a8(0x10e)]>0x0);if(_0x493480[_0x35e1a8(0x10e)]===0x0){alert(_0x35e1a8(0x107));return;}showSpinner();try{await Promise['all'](_0x493480[_0x35e1a8(0xcc)](_0x227266=>getDocument(_0x227266))),hideSpinner();}catch(_0x4c1f2d){console[_0x35e1a8(0x100)](_0x35e1a8(0xc8),_0x4c1f2d),hideSpinner();}}),$(a0_0x3e9f98(0xe0))['on'](a0_0x3e9f98(0xbf),function(){const _0x3588e9=a0_0x3e9f98;if($('#resultContainer')[_0x3588e9(0x10b)]()[_0x3588e9(0x10e)]===0x0){alert('No\x20hay\x20datos\x20para\x20descargar.');return;}exportResultContainerToCSV(_0x3588e9(0xe3));});const getToken=()=>{const _0x13a1ac=a0_0x3e9f98;if(localStorage[_0x13a1ac(0xe6)](_0x13a1ac(0xe1)))return localStorage[_0x13a1ac(0xe6)]('token');$['ajax']({'url':hostLogin,'type':_0x13a1ac(0xc7),'contentType':'application/json','data':JSON['stringify'](dataLogin),'success':function(_0x49f136){const _0x4370a6=_0x13a1ac,_0xe6c06c=_0x49f136[_0x4370a6(0xe1)];return localStorage[_0x4370a6(0xe4)]('token',_0xe6c06c),_0xe6c06c;},'error':function(_0x33d5d4){const _0x8993ed=_0x13a1ac;return console[_0x8993ed(0x100)](_0x8993ed(0xdc),_0x33d5d4),null;}});},getParams=_0x59d09d=>{const _0x41e9d4=a0_0x3e9f98;return encodeURIComponent(JSON[_0x41e9d4(0x106)]({'Nombre':_0x41e9d4(0xbb),'Descripcion':'SERVICIOS\x20PRESTADOS\x20A\x20PACIENTES','SentenciaSQL':'','Estado':_0x41e9d4(0xd4),'Parametros':[{'Nombre':_0x41e9d4(0x111),'Campo':_0x41e9d4(0xea),'Tipo':_0x41e9d4(0x114),'DbNombre':_0x41e9d4(0x111),'DbNombreCompleto':_0x41e9d4(0x10d),'DbTamano':0x1e,'DbTipo':_0x41e9d4(0x114),'Valor':_0x59d09d,'Oid':0x1,'IdBloqueo':null,'RegistroEliminado':![],'OidResult':null}],'formato':_0x41e9d4(0xd1),'SerializadoXml':!![],'Oid':0x1a,'IdBloqueo':null,'RegistroEliminado':![],'OidResult':null}));},readExcelFromBlob=_0x1501da=>{const _0x306029=a0_0x3e9f98,_0x1965e6=new FileReader();_0x1965e6[_0x306029(0xc1)]=function(_0x44bae0){const _0x2db94f=_0x306029,_0x50102=new Uint8Array(_0x44bae0[_0x2db94f(0xfe)][_0x2db94f(0x116)]),_0x5e7992=XLSX[_0x2db94f(0x113)](_0x50102,{'type':_0x2db94f(0x118)}),_0x34e047=_0x5e7992[_0x2db94f(0xd8)][0x0],_0x4d5ef5=_0x5e7992[_0x2db94f(0xc6)][_0x34e047],_0x3e7a25=XLSX[_0x2db94f(0xd3)][_0x2db94f(0xf0)](_0x4d5ef5,{'header':0x1});_0x3e7a25['forEach']((_0x3e254f,_0x479029)=>{const _0xf55dd3=_0x2db94f;if(_0x479029>0x0){let _0x2cee26=_0x3e254f[0x1],_0x278af9=_0x3e254f[0x2]+'\x20'+_0x3e254f[0x3]+'\x20'+_0x3e254f[0x4]+'\x20'+_0x3e254f[0x5],_0x2264d1=_0x3e254f[0x6],_0x6d59cb=_0x3e254f[0x8],_0x2be7ac=_0x3e254f[0x9],_0x49bd68=_0x3e254f[0x14],_0x4c2264=_0x3e254f[0x15],_0x2e35f0=excelDateToJSDate(_0x3e254f[0x1e]);$(_0xf55dd3(0xd2))[_0xf55dd3(0xf1)]('<p>'+_0x2cee26+',\x20'+_0x278af9+',\x20'+_0x2264d1+',\x20'+_0x6d59cb+',\x20'+_0x2be7ac+',\x20'+_0x49bd68+',\x20'+_0x4c2264+',\x20'+excelDateToJSDate(_0x2e35f0)+'</p>');}});},_0x1965e6[_0x306029(0x105)](_0x1501da);},excelDateToJSDate=_0x5d2d41=>{const _0x6d59a5=a0_0x3e9f98,_0x30d965=_0x5d2d41-0x63e1,_0x435f1d=_0x30d965*0x15180,_0x397a02=new Date(_0x435f1d*0x3e8),_0x5c6f4a=String(_0x397a02[_0x6d59a5(0xde)]())[_0x6d59a5(0xf8)](0x2,'0'),_0x323570=String(_0x397a02['getUTCMonth']()+0x1)[_0x6d59a5(0xf8)](0x2,'0'),_0x24dec1=_0x397a02[_0x6d59a5(0x102)]();return _0x5c6f4a+'/'+_0x323570+'/'+_0x24dec1;},getDocument=_0x4d58d9=>{const _0x4dfc04=a0_0x3e9f98;return $('#resultContainer')['children']()[_0x4dfc04(0x10e)]===0x0&&$(_0x4dfc04(0xd2))[_0x4dfc04(0xf1)](_0x4dfc04(0xdf)),new Promise(_0x4fd930=>{const _0x503c12=_0x4dfc04;$['ajax']({'url':hostDocument,'type':_0x503c12(0x115),'headers':{'repparams':getParams(_0x4d58d9),'Authorization':_0x503c12(0xfc)+getToken()},'xhrFields':{'responseType':_0x503c12(0xff)},'success':function(_0x4e4941){const _0x5e3390=_0x503c12,_0x26da3a=new FileReader();_0x26da3a[_0x5e3390(0xc1)]=function(_0x381880){const _0x40bf84=_0x5e3390,_0xcf3b91=new Uint8Array(_0x381880[_0x40bf84(0xfe)][_0x40bf84(0x116)]),_0xe911b2=XLSX[_0x40bf84(0x113)](_0xcf3b91,{'type':_0x40bf84(0x118)}),_0x38d259=_0xe911b2['SheetNames'][0x0],_0x98b23e=_0xe911b2[_0x40bf84(0xc6)][_0x38d259],_0x5eeab5=XLSX['utils'][_0x40bf84(0xf0)](_0x98b23e,{'header':0x1});let _0x27564b=![],_0x5bd026=[];_0x5eeab5[_0x40bf84(0xfd)]((_0x4a0fc6,_0x32ea0d)=>{const _0x58dfa2=_0x40bf84;if(_0x32ea0d>0x0){const _0x30ee7a=_0x4a0fc6[0x1],_0x3cb8be=replaceAccents(_0x4a0fc6[0x2]+'\x20'+_0x4a0fc6[0x3]+'\x20'+_0x4a0fc6[0x4]+'\x20'+_0x4a0fc6[0x5]),_0x3a851d=_0x4a0fc6[0x6],_0x3de2d6=replaceAccents(_0x4a0fc6[0x8]),_0x2573ff=replaceAccents(_0x4a0fc6[0x9]),_0xb7e557=_0x4a0fc6[0x14],_0x1b32e7=replaceAccents(_0x4a0fc6[0x15]),_0x310ee5=excelDateToJSDate(_0x4a0fc6[0x1e]);if(noImprimir[_0x58dfa2(0x10c)](_0xd962c2=>_0x1b32e7[_0x58dfa2(0xc5)](_0xd962c2[_0x58dfa2(0xe8)]())))return;if(!_0x30ee7a){$(_0x58dfa2(0xd2))[_0x58dfa2(0xf1)](_0x58dfa2(0xf7)+_0x4d58d9+';\x20sin\x20citas</p>'),_0x27564b=!![];return;}!_0x5bd026[_0x58dfa2(0xc5)](_0xb7e557)&&$(_0x58dfa2(0xd2))[_0x58dfa2(0xf1)]('<p>'+_0x30ee7a+';\x20'+_0x3cb8be+';\x20'+_0x3a851d+';\x20'+_0x3de2d6+';\x20'+_0x2573ff+';\x20'+_0xb7e557+';\x20'+_0x1b32e7+';\x20'+_0x310ee5+_0x58dfa2(0xdb)),_0x5bd026[_0x58dfa2(0xbe)](_0xb7e557),_0x27564b=!![];}}),!_0x27564b&&$(_0x40bf84(0xd2))[_0x40bf84(0xf1)](_0x40bf84(0xf7)+_0x4d58d9+_0x40bf84(0xf2));},_0x26da3a[_0x5e3390(0x105)](_0x4e4941),_0x4fd930();},'error':function(_0x4d1a34){const _0x485d12=_0x503c12;console['error'](_0x485d12(0xc3),_0x4d1a34),_0x4fd930();}});});},exportResultContainerToCSV=_0x2a0a6b=>{const _0x4d30da=a0_0x3e9f98,_0x39c960=[];$(_0x4d30da(0xd2))[_0x4d30da(0x10b)]()[_0x4d30da(0xe9)](function(){const _0x104f08=_0x4d30da,_0x3d04ea=$(this)[_0x104f08(0xfb)]()[_0x104f08(0xbc)]();_0x3d04ea&&_0x39c960[_0x104f08(0xbe)](_0x3d04ea);});const _0x37bd24=_0x39c960['join']('\x0a'),_0x441880=new Blob([_0x37bd24],{'type':_0x4d30da(0xd5)}),_0x3c6167=document[_0x4d30da(0x110)]('a'),_0xdc02cf=URL[_0x4d30da(0xe2)](_0x441880);_0x3c6167['setAttribute'](_0x4d30da(0xc4),_0xdc02cf),_0x3c6167[_0x4d30da(0x104)]('download',_0x2a0a6b+_0x4d30da(0x10f)),_0x3c6167[_0x4d30da(0xd0)][_0x4d30da(0xd7)]=_0x4d30da(0xc9),document['body'][_0x4d30da(0xcb)](_0x3c6167),_0x3c6167['click'](),document[_0x4d30da(0xec)][_0x4d30da(0xdd)](_0x3c6167);},replaceAccents=_0x1a7e25=>{const _0x47df71=a0_0x3e9f98;if(!_0x1a7e25)return'';return _0x1a7e25[_0x47df71(0x109)](_0x47df71(0xf4))[_0x47df71(0xf5)](/[\u0300-\u036f]/g,'');};