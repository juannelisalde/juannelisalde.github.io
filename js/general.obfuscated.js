const a0_0x2e6da7=a0_0x13e0;function a0_0x13e0(_0x3d5409,_0x1bdc95){const _0x49c23f=a0_0x49c2();return a0_0x13e0=function(_0x13e0e8,_0x4f3bba){_0x13e0e8=_0x13e0e8-0x153;let _0x5f7ace=_0x49c23f[_0x13e0e8];return _0x5f7ace;},a0_0x13e0(_0x3d5409,_0x1bdc95);}(function(_0x1ab29a,_0xd6a493){const _0x31c237=a0_0x13e0,_0x440f24=_0x1ab29a();while(!![]){try{const _0x15d39f=-parseInt(_0x31c237(0x1a7))/0x1*(parseInt(_0x31c237(0x1a9))/0x2)+-parseInt(_0x31c237(0x1c7))/0x3+-parseInt(_0x31c237(0x16e))/0x4+parseInt(_0x31c237(0x1b8))/0x5+parseInt(_0x31c237(0x157))/0x6+parseInt(_0x31c237(0x17c))/0x7+-parseInt(_0x31c237(0x178))/0x8*(-parseInt(_0x31c237(0x196))/0x9);if(_0x15d39f===_0xd6a493)break;else _0x440f24['push'](_0x440f24['shift']());}catch(_0x530f2c){_0x440f24['push'](_0x440f24['shift']());}}}(a0_0x49c2,0x5fc0e));const hostLogin=a0_0x2e6da7(0x17b),dataLogin={'oidUsuario':0x1,'oidCentroAtencion':0x1},hostDocument=a0_0x2e6da7(0x1c2),hostFolio=a0_0x2e6da7(0x1bd);function a0_0x49c2(){const _0x1c4fa6=['data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,','XLSX\x20PLANO','appendChild','693LuLXkH','#formFormatDates','getUTCDate','.clean','empty','getElementById','length','#formDownloadDates','some','preventDefault','GET','name','.results','push','file','getItem','application/json','433cqPhpV','toUpperCase','34PkCYiB','@DOCUMENTO','https://medyscol.com/prueba/general.php','token','String','readAsArrayBuffer','#resultContainerFormatDates','find','Fecha\x20inválida','SERVICIOS\x20PRESTADOS\x20A\x20PACIENTES','utils','text/csv;charset=utf-8;','Activo','CARIES\x20DE\x20LA\x20DENTINA','No\x20se\x20encontraron\x20documentos\x20válidos.','2871045XVdaKB','Error\x20al\x20obtener\x20el\x20token:','target','removeClass','trim','https://citas.usiese.gov.co:6007/api/HistoriaClinica/HistoriaClinicaConsulta/ObtenerHistoricoFolios/?oidIngreso=0&directivas=true&hcUnificada=false&id=','CONSULTA\x20EXTERNA','array','setItem','<p>','https://citas.usiese.gov.co:6007/api/Generales/ApiGeReporteGenerado/ExportarReporte','sort','#copyFormattedDates','<br>','join','2269413IxzQGP','href','catch','blob',';\x20sin\x20citas</p>','setAttribute','clipboard','replace','onload','html','result','796716FRkoON','append','each','TRIAGE','val','read','Resultado.csv','#dates','body','#resultContainerFormatDatesCard','d-none','padStart','Bearer\x20','ajax','text','children','#resultContainerDownloadDatesCard','includes','#resultContainerDownloadDates','#downloadCSV','Sheets','POST','getUTCMonth','2643092sWicJV','error','parent','split','writeText','Error\x20al\x20obtener\x20el\x20documento:','getUTCFullYear','Error\x20al\x20copiar\x20las\x20fechas:\x20','stringify','visibility','114568HNuISM','Error\x20al\x20procesar\x20los\x20documentos:','download','https://citas.usiese.gov.co:6007/api/Generales/ApiGeSeguridad/IniciarSesionCentroAtencion','49693zQaXFN','input','createElement','#spinner','forEach','removeChild','GENPACIEN.PACNUMDOC\x20=','sheet_to_json','.csv','test','map','createObjectURL','files','submit','DOCUMENTO','style','click','normalize','filter','then','</p>','#documents','addClass'];a0_0x49c2=function(){return _0x1c4fa6;};return a0_0x49c2();}let allData=[];const noPrintEspecialidad=['ODONTOLOGIA\x20GENERAL'],noPrintDiagnostico=[a0_0x2e6da7(0x1b6)],noImprimir=[a0_0x2e6da7(0x1be),'URGENCIAS',a0_0x2e6da7(0x15a)],showSpinner=()=>{const _0x4e0af8=a0_0x2e6da7;$('#spinner')[_0x4e0af8(0x1bb)]('d-none');},hideSpinner=()=>{const _0x52b6c9=a0_0x2e6da7;$(_0x52b6c9(0x17f))[_0x52b6c9(0x192)](_0x52b6c9(0x161));};$(a0_0x2e6da7(0x199))['on'](a0_0x2e6da7(0x18c),function(){const _0x54b385=a0_0x2e6da7;$(this)[_0x54b385(0x170)]()[_0x54b385(0x1b0)]('input')[_0x54b385(0x15b)](''),$(this)[_0x54b385(0x170)]()['find']('textarea')[_0x54b385(0x15b)](''),$(_0x54b385(0x1a2))[_0x54b385(0x192)]('d-none');}),$(a0_0x2e6da7(0x191))['on'](a0_0x2e6da7(0x17d),function(){const _0x9220e4=a0_0x2e6da7,_0x141200=/^[0-9,\s]*$/;let _0x184f1d=$(this)[_0x9220e4(0x15b)]();_0x184f1d=_0x184f1d['replace'](/[\n\r]+/g,','),!_0x141200[_0x9220e4(0x185)](_0x184f1d)&&(_0x184f1d=_0x184f1d[_0x9220e4(0x153)](/[^0-9,\s,]/g,'')),$(this)[_0x9220e4(0x15b)](_0x184f1d);}),$(a0_0x2e6da7(0x19d))['on']('submit',async function(_0x5a17df){const _0x1e76db=a0_0x2e6da7;_0x5a17df['preventDefault'](),$(_0x1e76db(0x169))[_0x1e76db(0x19a)](),allData=[];let _0x56669b=$(_0x1e76db(0x191))[_0x1e76db(0x15b)]()[_0x1e76db(0x171)](',');_0x56669b=_0x56669b[_0x1e76db(0x186)](_0xba74aa=>_0xba74aa['trim']()),_0x56669b[_0x1e76db(0x1c3)]((_0x51838c,_0x1bd250)=>_0x51838c-_0x1bd250),_0x56669b=[...new Set(_0x56669b)],_0x56669b=_0x56669b[_0x1e76db(0x18e)](_0x1a3452=>_0x1a3452!==''&&_0x1a3452[_0x1e76db(0x19c)]>0x0);if(_0x56669b['length']===0x0){alert(_0x1e76db(0x1b7));return;}showSpinner();try{await Promise['all'](_0x56669b[_0x1e76db(0x186)](_0x47537f=>getDocument(_0x47537f))),$(_0x1e76db(0x167))['removeClass']('d-none'),hideSpinner();}catch(_0x2570cb){console['error'](_0x1e76db(0x179),_0x2570cb),hideSpinner();}}),$(a0_0x2e6da7(0x16a))['on']('click',function(){const _0x122a9c=a0_0x2e6da7;if($(_0x122a9c(0x169))[_0x122a9c(0x166)]()[_0x122a9c(0x19c)]===0x0){alert('No\x20hay\x20datos\x20para\x20descargar.');return;}exportResultContainerToCSV(_0x122a9c(0x15d));});const getToken=()=>{const _0x5c3399=a0_0x2e6da7;if(localStorage[_0x5c3399(0x1a5)](_0x5c3399(0x1ac)))return localStorage[_0x5c3399(0x1a5)](_0x5c3399(0x1ac));$[_0x5c3399(0x164)]({'url':hostLogin,'type':_0x5c3399(0x16c),'contentType':_0x5c3399(0x1a6),'data':JSON[_0x5c3399(0x176)](dataLogin),'success':function(_0x3a7c64){const _0x253e69=_0x5c3399,_0x3c95b4=_0x3a7c64[_0x253e69(0x1ac)];return localStorage[_0x253e69(0x1c0)]('token',_0x3c95b4),_0x3c95b4;},'error':function(_0x2ebdd2){const _0x4ab52c=_0x5c3399;return console[_0x4ab52c(0x16f)](_0x4ab52c(0x1b9),_0x2ebdd2),null;}});},getParams=_0xfe41c8=>{const _0x20e1c9=a0_0x2e6da7;return encodeURIComponent(JSON[_0x20e1c9(0x176)]({'Nombre':'SERVICIOS\x20PRESTADOS\x20A\x20PACIENTES','Descripcion':_0x20e1c9(0x1b2),'SentenciaSQL':'','Estado':_0x20e1c9(0x1b5),'Parametros':[{'Nombre':'DOCUMENTO','Campo':_0x20e1c9(0x182),'Tipo':_0x20e1c9(0x1ad),'DbNombre':_0x20e1c9(0x18a),'DbNombreCompleto':_0x20e1c9(0x1aa),'DbTamano':0x1e,'DbTipo':_0x20e1c9(0x1ad),'Valor':_0xfe41c8,'Oid':0x1,'IdBloqueo':null,'RegistroEliminado':![],'OidResult':null}],'formato':_0x20e1c9(0x194),'SerializadoXml':!![],'Oid':0x1a,'IdBloqueo':null,'RegistroEliminado':![],'OidResult':null}));},readExcelFromBlob=_0x564987=>{const _0x2c2905=a0_0x2e6da7,_0x1e664f=new FileReader();_0x1e664f['onload']=function(_0xc22f4e){const _0x115b78=a0_0x13e0,_0x34fccb=new Uint8Array(_0xc22f4e[_0x115b78(0x1ba)][_0x115b78(0x156)]),_0x86919f=XLSX['read'](_0x34fccb,{'type':'array'}),_0x5c0a8f=_0x86919f['SheetNames'][0x0],_0x3f08a7=_0x86919f[_0x115b78(0x16b)][_0x5c0a8f],_0x290bb0=XLSX[_0x115b78(0x1b3)][_0x115b78(0x183)](_0x3f08a7,{'header':0x1});_0x290bb0[_0x115b78(0x180)]((_0x2c4083,_0x46e515)=>{const _0x479205=_0x115b78;if(_0x46e515>0x0){let _0x402596=_0x2c4083[0x1],_0x223436=_0x2c4083[0x2]+'\x20'+_0x2c4083[0x3]+'\x20'+_0x2c4083[0x4]+'\x20'+_0x2c4083[0x5],_0x3d7882=_0x2c4083[0x6],_0x101e59=_0x2c4083[0x8],_0x5d3a9e=_0x2c4083[0x9],_0x509dbf=_0x2c4083[0x14],_0x2ae566=_0x2c4083[0x15],_0x2dba5a=excelDateToJSDate(_0x2c4083[0x1e]);$(_0x479205(0x169))[_0x479205(0x158)](_0x479205(0x1c1)+_0x402596+',\x20'+_0x223436+',\x20'+_0x3d7882+',\x20'+_0x101e59+',\x20'+_0x5d3a9e+',\x20'+_0x509dbf+',\x20'+_0x2ae566+',\x20'+excelDateToJSDate(_0x2dba5a)+_0x479205(0x190));}});},_0x1e664f[_0x2c2905(0x1ae)](_0x564987);},excelDateToJSDate=_0x26480f=>{const _0x18b6d8=a0_0x2e6da7,_0x4f4ddf=_0x26480f-0x63e1,_0x52f0f8=_0x4f4ddf*0x15180,_0x668f69=new Date(_0x52f0f8*0x3e8),_0xd143ef=String(_0x668f69[_0x18b6d8(0x198)]())[_0x18b6d8(0x162)](0x2,'0'),_0x2932b5=String(_0x668f69[_0x18b6d8(0x16d)]()+0x1)[_0x18b6d8(0x162)](0x2,'0'),_0x40dfeb=_0x668f69[_0x18b6d8(0x174)]();return _0xd143ef+'/'+_0x2932b5+'/'+_0x40dfeb;},getDocument=_0x4fc982=>{const _0x36dab5=a0_0x2e6da7;return $(_0x36dab5(0x169))['children']()[_0x36dab5(0x19c)]===0x0&&$(_0x36dab5(0x169))[_0x36dab5(0x158)]('<p><b>PACNUMDOC;\x20NOMBRE;\x20SEXO;\x20EDAD_ACTUAL;\x20EDAD_SERVICIO;\x20SIPCODIGO;\x20SIPNOMBRE;\x20SERFECSER</b></p>'),new Promise(_0x51fd24=>{const _0x1dca35=_0x36dab5;$[_0x1dca35(0x164)]({'url':hostDocument,'type':_0x1dca35(0x1a0),'headers':{'repparams':getParams(_0x4fc982),'Authorization':_0x1dca35(0x163)+getToken()},'xhrFields':{'responseType':_0x1dca35(0x1ca)},'success':function(_0x17ee76){const _0xa80248=_0x1dca35,_0x2c9fac=new FileReader();_0x2c9fac[_0xa80248(0x154)]=function(_0x27354b){const _0x5c6c2a=_0xa80248,_0x16930b=new Uint8Array(_0x27354b[_0x5c6c2a(0x1ba)][_0x5c6c2a(0x156)]),_0x458889=XLSX[_0x5c6c2a(0x15c)](_0x16930b,{'type':_0x5c6c2a(0x1bf)}),_0x2d67f6=_0x458889['SheetNames'][0x0],_0xab74a5=_0x458889[_0x5c6c2a(0x16b)][_0x2d67f6],_0x1a5821=XLSX[_0x5c6c2a(0x1b3)][_0x5c6c2a(0x183)](_0xab74a5,{'header':0x1});let _0x380b1c=![],_0x4d0476=[];_0x1a5821[_0x5c6c2a(0x180)]((_0x5874ef,_0x90bec5)=>{const _0x2aad7d=_0x5c6c2a;if(_0x90bec5>0x0){const _0x338471=_0x5874ef[0x1],_0x181791=replaceAccents(_0x5874ef[0x2]+'\x20'+_0x5874ef[0x3]+'\x20'+_0x5874ef[0x4]+'\x20'+_0x5874ef[0x5]),_0xc6070b=_0x5874ef[0x6],_0x584072=replaceAccents(_0x5874ef[0x8]),_0x299309=replaceAccents(_0x5874ef[0x9]),_0x5be83d=_0x5874ef[0x14],_0x37bd36=replaceAccents(_0x5874ef[0x15]),_0x5f1250=excelDateToJSDate(_0x5874ef[0x1e]);if(noImprimir[_0x2aad7d(0x19e)](_0x37e4af=>_0x37bd36['includes'](_0x37e4af[_0x2aad7d(0x1a8)]())))return;if(!_0x338471){$(_0x2aad7d(0x169))[_0x2aad7d(0x158)](_0x2aad7d(0x1c1)+_0x4fc982+_0x2aad7d(0x1cb)),_0x380b1c=!![];return;}!_0x4d0476[_0x2aad7d(0x168)](_0x5be83d)&&$('#resultContainerDownloadDates')['append'](_0x2aad7d(0x1c1)+_0x338471+';\x20'+_0x181791+';\x20'+_0xc6070b+';\x20'+_0x584072+';\x20'+_0x299309+';\x20'+_0x5be83d+';\x20'+_0x37bd36+';\x20'+_0x5f1250+_0x2aad7d(0x190)),_0x4d0476[_0x2aad7d(0x1a3)](_0x5be83d),_0x380b1c=!![];}}),!_0x380b1c&&$(_0x5c6c2a(0x169))[_0x5c6c2a(0x158)](_0x5c6c2a(0x1c1)+_0x4fc982+';\x20sin\x20PM</p>');},_0x2c9fac[_0xa80248(0x1ae)](_0x17ee76),_0x51fd24();},'error':function(_0xb46043){const _0xcf3d61=_0x1dca35;console['error'](_0xcf3d61(0x173),_0xb46043),_0x51fd24();}});});},exportResultContainerToCSV=_0x3b0254=>{const _0x3c099d=a0_0x2e6da7,_0x300a3a=[];$(_0x3c099d(0x169))[_0x3c099d(0x166)]()[_0x3c099d(0x159)](function(){const _0x451a3c=_0x3c099d,_0x598422=$(this)[_0x451a3c(0x165)]()['trim']();_0x598422&&_0x300a3a[_0x451a3c(0x1a3)](_0x598422);});const _0x3d57fa=_0x300a3a[_0x3c099d(0x1c6)]('\x0a'),_0x38ff9a=new Blob([_0x3d57fa],{'type':_0x3c099d(0x1b4)}),_0x3e26f3=document['createElement']('a'),_0x418ac7=URL[_0x3c099d(0x187)](_0x38ff9a);_0x3e26f3[_0x3c099d(0x1cc)](_0x3c099d(0x1c8),_0x418ac7),_0x3e26f3['setAttribute'](_0x3c099d(0x17a),_0x3b0254+_0x3c099d(0x184)),_0x3e26f3[_0x3c099d(0x18b)][_0x3c099d(0x177)]='hidden',document[_0x3c099d(0x15f)]['appendChild'](_0x3e26f3),_0x3e26f3[_0x3c099d(0x18c)](),document[_0x3c099d(0x15f)][_0x3c099d(0x181)](_0x3e26f3);},replaceAccents=_0xedb2f9=>{const _0x535411=a0_0x2e6da7;if(!_0xedb2f9)return'';return _0xedb2f9[_0x535411(0x18d)]('NFD')[_0x535411(0x153)](/[\u0300-\u036f]/g,'');},processDates=_0x2fed2e=>{const _0x189960=a0_0x2e6da7;return _0x2fed2e[_0x189960(0x186)](_0x19f99e=>{const _0xe2222b=_0x189960,_0x3b3f16=_0x19f99e[_0xe2222b(0x171)]('/');if(_0x3b3f16['length']!==0x3)return _0xe2222b(0x1b1);let [_0x159441,_0x163b66,_0x219062]=_0x3b3f16[_0xe2222b(0x186)](_0x2a0f03=>parseInt(_0x2a0f03,0xa));if(_0x163b66>0xc)return _0x163b66+'/'+_0x159441+'/'+_0x219062;return _0x159441+'/'+_0x163b66+'/'+_0x219062;});};$(a0_0x2e6da7(0x197))['on'](a0_0x2e6da7(0x189),async function(_0x1d3d73){const _0x2e5698=a0_0x2e6da7;_0x1d3d73['preventDefault'](),showSpinner(),$('#resultContainerFormatDates')[_0x2e5698(0x19a)]();let _0x4ee2c1=$(_0x2e5698(0x15e))[_0x2e5698(0x15b)]()['replace'](/[\n\r]+/g,',')[_0x2e5698(0x171)](',');_0x4ee2c1=_0x4ee2c1['map'](_0x5aeeb1=>_0x5aeeb1[_0x2e5698(0x1bc)]()),_0x4ee2c1=_0x4ee2c1[_0x2e5698(0x18e)](_0xa18c6=>_0xa18c6!=='');const _0x5b7b8a=processDates(_0x4ee2c1);_0x5b7b8a['forEach'](_0x17908c=>{const _0x4e3ce5=_0x2e5698;$(_0x4e3ce5(0x1af))['append'](_0x17908c+'</br>');}),$(_0x2e5698(0x160))[_0x2e5698(0x1bb)]('d-none'),hideSpinner();}),$(a0_0x2e6da7(0x1c4))['on'](a0_0x2e6da7(0x18c),function(){const _0x554ef2=a0_0x2e6da7,_0x91d270=$(_0x554ef2(0x1af))[_0x554ef2(0x155)]()['trim']();if(_0x91d270){const _0x12612e=_0x91d270[_0x554ef2(0x171)](_0x554ef2(0x1c5))['map'](_0xbe48d3=>_0xbe48d3[_0x554ef2(0x1bc)]())['filter'](_0x35038b=>_0x35038b!=='')[_0x554ef2(0x1c6)]('\x0a');navigator[_0x554ef2(0x1cd)][_0x554ef2(0x172)](_0x12612e)[_0x554ef2(0x18f)](()=>{alert('Fechas\x20copiadas\x20al\x20portapapeles');})[_0x554ef2(0x1c9)](_0x1f1de1=>{const _0xb2acf=_0x554ef2;console[_0xb2acf(0x16f)](_0xb2acf(0x175),_0x1f1de1),alert('No\x20se\x20pudieron\x20copiar\x20las\x20fechas');});}else alert('No\x20hay\x20fechas\x20formateadas\x20para\x20copiar');}),$('#formExcel')['on'](a0_0x2e6da7(0x189),async function(_0x23bb8c){const _0xa2bbbf=a0_0x2e6da7;_0x23bb8c[_0xa2bbbf(0x19f)]();const _0x1bdecd=new FormData(this),_0x3b30e7=document[_0xa2bbbf(0x19b)](_0xa2bbbf(0x1a4)),_0x3db3f9=_0x3b30e7[_0xa2bbbf(0x188)][0x0][_0xa2bbbf(0x1a1)];showSpinner(),$[_0xa2bbbf(0x164)]({'url':_0xa2bbbf(0x1ab),'type':_0xa2bbbf(0x16c),'data':_0x1bdecd,'processData':![],'contentType':![],'success':function(_0xdfbd4f){const _0x53caa1=_0xa2bbbf,_0x1ebcf4=document[_0x53caa1(0x17e)]('a');_0x1ebcf4[_0x53caa1(0x1c8)]=_0x53caa1(0x193)+_0xdfbd4f,_0x1ebcf4[_0x53caa1(0x17a)]='reporte-'+_0x3db3f9,document['body'][_0x53caa1(0x195)](_0x1ebcf4),_0x1ebcf4[_0x53caa1(0x18c)](),document[_0x53caa1(0x15f)][_0x53caa1(0x181)](_0x1ebcf4),hideSpinner();},'error':function(_0x42eede){const _0x28a1b2=_0xa2bbbf;console[_0x28a1b2(0x16f)](_0x28a1b2(0x173),_0x42eede),hideSpinner();}});});