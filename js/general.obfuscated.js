const a0_0x555098=a0_0x33cf;(function(_0x495f81,_0x3f5a8c){const _0x10e7f9=a0_0x33cf,_0x178c61=_0x495f81();while(!![]){try{const _0xd139ef=parseInt(_0x10e7f9(0x123))/0x1*(-parseInt(_0x10e7f9(0x12d))/0x2)+-parseInt(_0x10e7f9(0x10b))/0x3+-parseInt(_0x10e7f9(0x11c))/0x4*(-parseInt(_0x10e7f9(0x13c))/0x5)+-parseInt(_0x10e7f9(0x128))/0x6*(parseInt(_0x10e7f9(0xe6))/0x7)+-parseInt(_0x10e7f9(0x101))/0x8+parseInt(_0x10e7f9(0xde))/0x9*(-parseInt(_0x10e7f9(0x10c))/0xa)+-parseInt(_0x10e7f9(0xfb))/0xb*(-parseInt(_0x10e7f9(0x13a))/0xc);if(_0xd139ef===_0x3f5a8c)break;else _0x178c61['push'](_0x178c61['shift']());}catch(_0x22b4e9){_0x178c61['push'](_0x178c61['shift']());}}}(a0_0x441f,0x5d74b));const hostLogin=a0_0x555098(0x100),dataLogin={'oidUsuario':0x1,'oidCentroAtencion':0x1},hostDocument=a0_0x555098(0x131),hostFolio=a0_0x555098(0xef);function a0_0x441f(){const _0x47d033=['each','7VYPdrm','SheetNames','Resultado.csv','text','GENPACIEN.PACNUMDOC\x20=','hidden','NFD','input','includes','https://citas.usiese.gov.co:6007/api/HistoriaClinica/HistoriaClinicaConsulta/ObtenerHistoricoFolios/?oidIngreso=0&directivas=true&hcUnificada=false&id=','token','Error\x20al\x20obtener\x20el\x20token:','setAttribute','href','trim','setItem','GET','click','#formDocuments','target','String','55HBFXRA','application/json','padStart',';\x20sin\x20citas</p>','DOCUMENTO','https://citas.usiese.gov.co:6007/api/Generales/ApiGeSeguridad/IniciarSesionCentroAtencion','5856744CLGBOg','getUTCDate','Sheets','length','onload','#documents','result','Activo','SERVICIOS\x20PRESTADOS\x20A\x20PACIENTES','readAsArrayBuffer','574467NHUQKy','30zHWJXT','replace','map','addClass','val','d-none','CONSULTA\x20EXTERNA','append','POST','normalize','sort','getUTCMonth','all','</p>','download','forEach','660DCHtPV','toUpperCase','test',';\x20sin\x20PM</p>','blob','#downloadCSV','body','77LeepPC','getUTCFullYear','filter','read','error','3161658lVBjTR','<p>','sheet_to_json','Bearer\x20','#spinner','7782KNFWFk','array','No\x20hay\x20datos\x20para\x20descargar.','utils','https://citas.usiese.gov.co:6007/api/Generales/ApiGeReporteGenerado/ExportarReporte','push','getItem','createObjectURL','appendChild','Error\x20al\x20procesar\x20los\x20documentos:','.csv','MEDICINA\x20GENERAL','removeChild','6457044ZcRmuO','submit','1205klOmAP','<p><b>PACNUMDOC;\x20NOMBRE;\x20SEXO;\x20EDAD_ACTUAL;\x20EDAD_SERVICIO;\x20SIPCODIGO;\x20SIPNOMBRE;\x20SERFECSER</b></p>','preventDefault','ajax','TRIAGE','1791819zhLRsw','CARIES\x20DE\x20LA\x20DENTINA','style','children','#resultContainer','join','some'];a0_0x441f=function(){return _0x47d033;};return a0_0x441f();}let allData=[];function a0_0x33cf(_0x564523,_0x23d43f){const _0x441f40=a0_0x441f();return a0_0x33cf=function(_0x33cfef,_0x11e710){_0x33cfef=_0x33cfef-0xde;let _0x4d5a77=_0x441f40[_0x33cfef];return _0x4d5a77;},a0_0x33cf(_0x564523,_0x23d43f);}const noPrintEspecialidad=['ODONTOLOGIA\x20GENERAL'],noPrintDiagnostico=[a0_0x555098(0xdf)],noImprimir=[a0_0x555098(0x138),a0_0x555098(0x112),'URGENCIAS',a0_0x555098(0x140)],showSpinner=()=>{const _0x7360ba=a0_0x555098;$(_0x7360ba(0x12c))['removeClass'](_0x7360ba(0x111));},hideSpinner=()=>{const _0x920e7d=a0_0x555098;$(_0x920e7d(0x12c))[_0x920e7d(0x10f)]('d-none');};$('#documents')['on'](a0_0x555098(0xed),function(){const _0x5e3b20=a0_0x555098,_0x425e5f=/^[0-9,\s]*$/;let _0x7c67d4=$(this)[_0x5e3b20(0x110)]();_0x7c67d4=_0x7c67d4[_0x5e3b20(0x10d)](/[\n\r]+/g,','),!_0x425e5f[_0x5e3b20(0x11e)](_0x7c67d4)&&(_0x7c67d4=_0x7c67d4[_0x5e3b20(0x10d)](/[^0-9,\s,]/g,'')),$(this)['val'](_0x7c67d4);}),$(a0_0x555098(0xf8))['on'](a0_0x555098(0x13b),async function(_0x5bed6b){const _0x38fb8b=a0_0x555098;_0x5bed6b[_0x38fb8b(0x13e)](),$(_0x38fb8b(0xe2))['empty'](),allData=[];let _0x2db27f=$(_0x38fb8b(0x106))['val']()['split'](',');_0x2db27f=_0x2db27f[_0x38fb8b(0x10e)](_0x21b1e0=>_0x21b1e0[_0x38fb8b(0xf4)]()),_0x2db27f[_0x38fb8b(0x116)]((_0x4dbf57,_0x2bfc70)=>_0x4dbf57-_0x2bfc70),_0x2db27f=[...new Set(_0x2db27f)],_0x2db27f=_0x2db27f[_0x38fb8b(0x125)](_0x5edd43=>_0x5edd43!==''&&_0x5edd43[_0x38fb8b(0x104)]>0x0);if(_0x2db27f[_0x38fb8b(0x104)]===0x0){alert('No\x20se\x20encontraron\x20documentos\x20vÃ¡lidos.');return;}showSpinner();try{await Promise[_0x38fb8b(0x118)](_0x2db27f[_0x38fb8b(0x10e)](_0x92237f=>getDocument(_0x92237f))),hideSpinner();}catch(_0x36cd0b){console['error'](_0x38fb8b(0x136),_0x36cd0b),hideSpinner();}}),$(a0_0x555098(0x121))['on'](a0_0x555098(0xf7),function(){const _0x190f74=a0_0x555098;if($(_0x190f74(0xe2))[_0x190f74(0xe1)]()['length']===0x0){alert(_0x190f74(0x12f));return;}exportResultContainerToCSV(_0x190f74(0xe8));});const getToken=()=>{const _0x147160=a0_0x555098;if(localStorage[_0x147160(0x133)](_0x147160(0xf0)))return localStorage[_0x147160(0x133)](_0x147160(0xf0));$[_0x147160(0x13f)]({'url':hostLogin,'type':_0x147160(0x114),'contentType':_0x147160(0xfc),'data':JSON['stringify'](dataLogin),'success':function(_0xeefd06){const _0x1a6760=_0x147160,_0x185768=_0xeefd06[_0x1a6760(0xf0)];return localStorage[_0x1a6760(0xf5)](_0x1a6760(0xf0),_0x185768),_0x185768;},'error':function(_0x1b6c35){const _0x2746a9=_0x147160;return console[_0x2746a9(0x127)](_0x2746a9(0xf1),_0x1b6c35),null;}});},getParams=_0x2d7fcf=>{const _0x3bc6e7=a0_0x555098;return encodeURIComponent(JSON['stringify']({'Nombre':_0x3bc6e7(0x109),'Descripcion':_0x3bc6e7(0x109),'SentenciaSQL':'','Estado':_0x3bc6e7(0x108),'Parametros':[{'Nombre':_0x3bc6e7(0xff),'Campo':_0x3bc6e7(0xea),'Tipo':_0x3bc6e7(0xfa),'DbNombre':'DOCUMENTO','DbNombreCompleto':'@DOCUMENTO','DbTamano':0x1e,'DbTipo':'String','Valor':_0x2d7fcf,'Oid':0x1,'IdBloqueo':null,'RegistroEliminado':![],'OidResult':null}],'formato':'XLSX\x20PLANO','SerializadoXml':!![],'Oid':0x1a,'IdBloqueo':null,'RegistroEliminado':![],'OidResult':null}));},readExcelFromBlob=_0x2e8c96=>{const _0x1c21e3=a0_0x555098,_0x2231d5=new FileReader();_0x2231d5[_0x1c21e3(0x105)]=function(_0x5b1791){const _0x5781b0=_0x1c21e3,_0x56ee8d=new Uint8Array(_0x5b1791['target'][_0x5781b0(0x107)]),_0x28643c=XLSX[_0x5781b0(0x126)](_0x56ee8d,{'type':_0x5781b0(0x12e)}),_0x3e5e8e=_0x28643c['SheetNames'][0x0],_0x152f2b=_0x28643c[_0x5781b0(0x103)][_0x3e5e8e],_0x608036=XLSX[_0x5781b0(0x130)][_0x5781b0(0x12a)](_0x152f2b,{'header':0x1});_0x608036[_0x5781b0(0x11b)]((_0x3b7ea6,_0x3ff9b7)=>{const _0x14176c=_0x5781b0;if(_0x3ff9b7>0x0){let _0x5927f6=_0x3b7ea6[0x1],_0x1fbc53=_0x3b7ea6[0x2]+'\x20'+_0x3b7ea6[0x3]+'\x20'+_0x3b7ea6[0x4]+'\x20'+_0x3b7ea6[0x5],_0x102bc5=_0x3b7ea6[0x6],_0x598b01=_0x3b7ea6[0x8],_0x3ed349=_0x3b7ea6[0x9],_0x358d99=_0x3b7ea6[0x14],_0x2425b9=_0x3b7ea6[0x15],_0x2f6777=excelDateToJSDate(_0x3b7ea6[0x1e]);$(_0x14176c(0xe2))['append'](_0x14176c(0x129)+_0x5927f6+',\x20'+_0x1fbc53+',\x20'+_0x102bc5+',\x20'+_0x598b01+',\x20'+_0x3ed349+',\x20'+_0x358d99+',\x20'+_0x2425b9+',\x20'+excelDateToJSDate(_0x2f6777)+_0x14176c(0x119));}});},_0x2231d5['readAsArrayBuffer'](_0x2e8c96);},excelDateToJSDate=_0x2da6a5=>{const _0x33dee1=a0_0x555098,_0x46746f=_0x2da6a5-0x63e1,_0x14d84c=_0x46746f*0x15180,_0x330908=new Date(_0x14d84c*0x3e8),_0x2740d1=String(_0x330908[_0x33dee1(0x102)]())[_0x33dee1(0xfd)](0x2,'0'),_0x1618b1=String(_0x330908[_0x33dee1(0x117)]()+0x1)[_0x33dee1(0xfd)](0x2,'0'),_0x15b5d1=_0x330908[_0x33dee1(0x124)]();return _0x2740d1+'/'+_0x1618b1+'/'+_0x15b5d1;},getDocument=_0x4fe273=>{const _0x5b340f=a0_0x555098;return $(_0x5b340f(0xe2))[_0x5b340f(0xe1)]()[_0x5b340f(0x104)]===0x0&&$(_0x5b340f(0xe2))[_0x5b340f(0x113)](_0x5b340f(0x13d)),new Promise(_0x13b79a=>{const _0x23e3cb=_0x5b340f;$['ajax']({'url':hostDocument,'type':_0x23e3cb(0xf6),'headers':{'repparams':getParams(_0x4fe273),'Authorization':_0x23e3cb(0x12b)+getToken()},'xhrFields':{'responseType':_0x23e3cb(0x120)},'success':function(_0x4afc47){const _0x31633e=_0x23e3cb,_0x384cb7=new FileReader();_0x384cb7[_0x31633e(0x105)]=function(_0x3aff63){const _0x7352d3=_0x31633e,_0x38d073=new Uint8Array(_0x3aff63[_0x7352d3(0xf9)]['result']),_0x26d254=XLSX['read'](_0x38d073,{'type':_0x7352d3(0x12e)}),_0x3d9065=_0x26d254[_0x7352d3(0xe7)][0x0],_0x4668bb=_0x26d254[_0x7352d3(0x103)][_0x3d9065],_0x307daa=XLSX[_0x7352d3(0x130)][_0x7352d3(0x12a)](_0x4668bb,{'header':0x1});let _0x4f3619=![];_0x307daa['forEach']((_0x94f5ad,_0x5e8cf6)=>{const _0x1ad9b7=_0x7352d3;if(_0x5e8cf6>0x0){const _0x519d72=_0x94f5ad[0x1],_0xf516ef=replaceAccents(_0x94f5ad[0x2]+'\x20'+_0x94f5ad[0x3]+'\x20'+_0x94f5ad[0x4]+'\x20'+_0x94f5ad[0x5]),_0x2ccb23=_0x94f5ad[0x6],_0x441b27=replaceAccents(_0x94f5ad[0x8]),_0x10e1c8=replaceAccents(_0x94f5ad[0x9]),_0x1d49fe=_0x94f5ad[0x14],_0x3ce82a=replaceAccents(_0x94f5ad[0x15]),_0x2a2363=excelDateToJSDate(_0x94f5ad[0x1e]);if(noImprimir[_0x1ad9b7(0xe4)](_0x59a783=>_0x3ce82a[_0x1ad9b7(0xee)](_0x59a783[_0x1ad9b7(0x11d)]())))return;if(!_0x519d72){$(_0x1ad9b7(0xe2))['append'](_0x1ad9b7(0x129)+_0x4fe273+_0x1ad9b7(0xfe)),_0x4f3619=!![];return;}$(_0x1ad9b7(0xe2))[_0x1ad9b7(0x113)](_0x1ad9b7(0x129)+_0x519d72+';\x20'+_0xf516ef+';\x20'+_0x2ccb23+';\x20'+_0x441b27+';\x20'+_0x10e1c8+';\x20'+_0x1d49fe+';\x20'+_0x3ce82a+';\x20'+_0x2a2363+'</p>'),_0x4f3619=!![];}}),!_0x4f3619&&$(_0x7352d3(0xe2))[_0x7352d3(0x113)](_0x7352d3(0x129)+_0x4fe273+_0x7352d3(0x11f));},_0x384cb7[_0x31633e(0x10a)](_0x4afc47),_0x13b79a();},'error':function(_0x2a0e37){const _0x1eb247=_0x23e3cb;console[_0x1eb247(0x127)]('Error\x20al\x20obtener\x20el\x20documento:',_0x2a0e37),_0x13b79a();}});});},exportResultContainerToCSV=_0x254ea0=>{const _0x56e597=a0_0x555098,_0x3b33c3=[];$(_0x56e597(0xe2))[_0x56e597(0xe1)]()[_0x56e597(0xe5)](function(){const _0x420743=_0x56e597,_0x39c9e1=$(this)[_0x420743(0xe9)]()[_0x420743(0xf4)]();_0x39c9e1&&_0x3b33c3[_0x420743(0x132)](_0x39c9e1);});const _0x347a72=_0x3b33c3[_0x56e597(0xe3)]('\x0a'),_0xadac79=new Blob([_0x347a72],{'type':'text/csv;charset=utf-8;'}),_0xbc686d=document['createElement']('a'),_0x3c6f00=URL[_0x56e597(0x134)](_0xadac79);_0xbc686d[_0x56e597(0xf2)](_0x56e597(0xf3),_0x3c6f00),_0xbc686d[_0x56e597(0xf2)](_0x56e597(0x11a),_0x254ea0+_0x56e597(0x137)),_0xbc686d[_0x56e597(0xe0)]['visibility']=_0x56e597(0xeb),document[_0x56e597(0x122)][_0x56e597(0x135)](_0xbc686d),_0xbc686d[_0x56e597(0xf7)](),document[_0x56e597(0x122)][_0x56e597(0x139)](_0xbc686d);},replaceAccents=_0x1f7fdf=>{const _0x5d5dae=a0_0x555098;if(!_0x1f7fdf)return'';return _0x1f7fdf[_0x5d5dae(0x115)](_0x5d5dae(0xec))[_0x5d5dae(0x10d)](/[\u0300-\u036f]/g,'');};