const a0_0xe671cb=a0_0x52ac;(function(_0x4acfde,_0x392bdb){const _0x549209=a0_0x52ac,_0x1c5bc8=_0x4acfde();while(!![]){try{const _0x4adc30=-parseInt(_0x549209(0x17f))/0x1*(-parseInt(_0x549209(0x16a))/0x2)+-parseInt(_0x549209(0x149))/0x3+parseInt(_0x549209(0x16d))/0x4+-parseInt(_0x549209(0x146))/0x5+parseInt(_0x549209(0x178))/0x6+-parseInt(_0x549209(0x177))/0x7+-parseInt(_0x549209(0x14d))/0x8*(-parseInt(_0x549209(0x159))/0x9);if(_0x4adc30===_0x392bdb)break;else _0x1c5bc8['push'](_0x1c5bc8['shift']());}catch(_0x3c1b2f){_0x1c5bc8['push'](_0x1c5bc8['shift']());}}}(a0_0x5212,0x90888));const hostLogin=a0_0xe671cb(0x141),dataLogin={'oidUsuario':0x1,'oidCentroAtencion':0x1},hostDocument=a0_0xe671cb(0x18c),hostFolio='https://citas.usiese.gov.co:6007/api/HistoriaClinica/HistoriaClinicaConsulta/ObtenerHistoricoFolios/?oidIngreso=0&directivas=true&hcUnificada=false&id=';let allData=[];const noPrintEspecialidad=[a0_0xe671cb(0x176)],noPrintDiagnostico=[a0_0xe671cb(0x187)],noImprimir=['CONSULTA\x20EXTERNA','URGENCIAS','TRIAGE'],showSpinner=()=>{const _0x5557b3=a0_0xe671cb;$(_0x5557b3(0x171))[_0x5557b3(0x196)](_0x5557b3(0x158));},hideSpinner=()=>{const _0x8132bd=a0_0xe671cb;$(_0x8132bd(0x171))[_0x8132bd(0x166)]('d-none');};$(a0_0xe671cb(0x15c))['on']('click',function(){const _0x14384b=a0_0xe671cb;$(this)['parent']()[_0x14384b(0x19a)](_0x14384b(0x151))['val'](''),$(this)[_0x14384b(0x17b)]()[_0x14384b(0x19a)](_0x14384b(0x18e))['val'](''),$(_0x14384b(0x169))[_0x14384b(0x166)](_0x14384b(0x158));}),$('#documents')['on'](a0_0xe671cb(0x151),function(){const _0x1ead72=a0_0xe671cb,_0x46fc10=/^[0-9,\s]*$/;let _0x409784=$(this)[_0x1ead72(0x192)]();_0x409784=_0x409784[_0x1ead72(0x143)](/[\n\r]+/g,','),!_0x46fc10[_0x1ead72(0x155)](_0x409784)&&(_0x409784=_0x409784[_0x1ead72(0x143)](/[^0-9,\s,]/g,'')),$(this)[_0x1ead72(0x192)](_0x409784);}),$(a0_0xe671cb(0x19f))['on'](a0_0xe671cb(0x191),async function(_0x1c3bec){const _0x3032b8=a0_0xe671cb;_0x1c3bec[_0x3032b8(0x184)](),$('#resultContainerDownloadDates')['empty'](),allData=[];let _0x150cf3=$(_0x3032b8(0x14e))[_0x3032b8(0x192)]()[_0x3032b8(0x190)](',');_0x150cf3=_0x150cf3[_0x3032b8(0x174)](_0xc26c7b=>_0xc26c7b[_0x3032b8(0x162)]()),_0x150cf3[_0x3032b8(0x197)]((_0x497d77,_0x2a873b)=>_0x497d77-_0x2a873b),_0x150cf3=[...new Set(_0x150cf3)],_0x150cf3=_0x150cf3['filter'](_0x1618af=>_0x1618af!==''&&_0x1618af[_0x3032b8(0x165)]>0x0);if(_0x150cf3[_0x3032b8(0x165)]===0x0){alert(_0x3032b8(0x19b));return;}showSpinner();try{await Promise[_0x3032b8(0x170)](_0x150cf3[_0x3032b8(0x174)](_0x1059c2=>getDocument(_0x1059c2))),$('#resultContainerDownloadDatesCard')[_0x3032b8(0x196)](_0x3032b8(0x158)),hideSpinner();}catch(_0x1d8dae){console['error']('Error\x20al\x20procesar\x20los\x20documentos:',_0x1d8dae),hideSpinner();}}),$('#downloadCSV')['on'](a0_0xe671cb(0x173),function(){const _0x3999a5=a0_0xe671cb;if($('#resultContainerDownloadDates')['children']()[_0x3999a5(0x165)]===0x0){alert(_0x3999a5(0x172));return;}exportResultContainerToCSV(_0x3999a5(0x16c));});function a0_0x52ac(_0x36e117,_0x1c0cef){const _0x52127f=a0_0x5212();return a0_0x52ac=function(_0x52ace8,_0x364c0a){_0x52ace8=_0x52ace8-0x141;let _0x3bfbcb=_0x52127f[_0x52ace8];return _0x3bfbcb;},a0_0x52ac(_0x36e117,_0x1c0cef);}function a0_0x5212(){const _0x7a8020=['DOCUMENTO','</br>','preventDefault',';\x20sin\x20citas</p>','token','CARIES\x20DE\x20LA\x20DENTINA','appendChild','padStart','body','blob','https://citas.usiese.gov.co:6007/api/Generales/ApiGeReporteGenerado/ExportarReporte','sheet_to_json','textarea','SheetNames','split','submit','val','getUTCDate','hidden','error','removeClass','sort','array','forEach','find','No\x20se\x20encontraron\x20documentos\x20válidos.','children','readAsArrayBuffer','SERVICIOS\x20PRESTADOS\x20A\x20PACIENTES','#formDownloadDates','<p>','normalize','https://citas.usiese.gov.co:6007/api/Generales/ApiGeSeguridad/IniciarSesionCentroAtencion','text/csv;charset=utf-8;','replace','<p><b>PACNUMDOC;\x20NOMBRE;\x20SEXO;\x20EDAD_ACTUAL;\x20EDAD_SERVICIO;\x20SIPCODIGO;\x20SIPNOMBRE;\x20SERFECSER</b></p>','Error\x20al\x20obtener\x20el\x20token:','4896945WFZGhP','#resultContainerFormatDates',';\x20sin\x20PM</p>','174255IZmgnq','target','push','Bearer\x20','310936TllsWa','#documents','text','GET','input','utils','each','#formFormatDates','test','Activo','onload','d-none','90DxdWeZ','#resultContainerDownloadDates','createElement','.clean','XLSX\x20PLANO','stringify','append','toUpperCase','setItem','trim','NFD','style','length','addClass','getUTCFullYear','</p>','.results','376JMOPFp','application/json','Resultado.csv','3927440fYsPyV','includes','POST','all','#spinner','No\x20hay\x20datos\x20para\x20descargar.','click','map','read','ODONTOLOGIA\x20GENERAL','6119827eRirPv','5234742uYkcLA','visibility','filter','parent','getItem','Fecha\x20inválida','String','1387ReYsGf','GENPACIEN.PACNUMDOC\x20=','result'];a0_0x5212=function(){return _0x7a8020;};return a0_0x5212();}const getToken=()=>{const _0x5dd3ef=a0_0xe671cb;if(localStorage[_0x5dd3ef(0x17c)](_0x5dd3ef(0x186)))return localStorage[_0x5dd3ef(0x17c)](_0x5dd3ef(0x186));$['ajax']({'url':hostLogin,'type':_0x5dd3ef(0x16f),'contentType':_0x5dd3ef(0x16b),'data':JSON[_0x5dd3ef(0x15e)](dataLogin),'success':function(_0x5ac0b8){const _0x814fc3=_0x5dd3ef,_0x461bf9=_0x5ac0b8[_0x814fc3(0x186)];return localStorage[_0x814fc3(0x161)](_0x814fc3(0x186),_0x461bf9),_0x461bf9;},'error':function(_0x1c129f){const _0x1af71a=_0x5dd3ef;return console[_0x1af71a(0x195)](_0x1af71a(0x145),_0x1c129f),null;}});},getParams=_0x4b03a6=>{const _0x6f456=a0_0xe671cb;return encodeURIComponent(JSON[_0x6f456(0x15e)]({'Nombre':_0x6f456(0x19e),'Descripcion':'SERVICIOS\x20PRESTADOS\x20A\x20PACIENTES','SentenciaSQL':'','Estado':_0x6f456(0x156),'Parametros':[{'Nombre':_0x6f456(0x182),'Campo':_0x6f456(0x180),'Tipo':_0x6f456(0x17e),'DbNombre':_0x6f456(0x182),'DbNombreCompleto':'@DOCUMENTO','DbTamano':0x1e,'DbTipo':_0x6f456(0x17e),'Valor':_0x4b03a6,'Oid':0x1,'IdBloqueo':null,'RegistroEliminado':![],'OidResult':null}],'formato':_0x6f456(0x15d),'SerializadoXml':!![],'Oid':0x1a,'IdBloqueo':null,'RegistroEliminado':![],'OidResult':null}));},readExcelFromBlob=_0x263a1d=>{const _0x9239f=a0_0xe671cb,_0x1d9afa=new FileReader();_0x1d9afa['onload']=function(_0x3631db){const _0x33fead=a0_0x52ac,_0x365156=new Uint8Array(_0x3631db[_0x33fead(0x14a)]['result']),_0x585b6e=XLSX[_0x33fead(0x175)](_0x365156,{'type':_0x33fead(0x198)}),_0x19629c=_0x585b6e[_0x33fead(0x18f)][0x0],_0x99acf0=_0x585b6e['Sheets'][_0x19629c],_0x297334=XLSX[_0x33fead(0x152)][_0x33fead(0x18d)](_0x99acf0,{'header':0x1});_0x297334['forEach']((_0x1c7000,_0x100b4e)=>{const _0x59ca73=_0x33fead;if(_0x100b4e>0x0){let _0x210667=_0x1c7000[0x1],_0x593c7a=_0x1c7000[0x2]+'\x20'+_0x1c7000[0x3]+'\x20'+_0x1c7000[0x4]+'\x20'+_0x1c7000[0x5],_0x48c6ed=_0x1c7000[0x6],_0x485e35=_0x1c7000[0x8],_0x3ed38b=_0x1c7000[0x9],_0x14759f=_0x1c7000[0x14],_0x30ed40=_0x1c7000[0x15],_0x1161b1=excelDateToJSDate(_0x1c7000[0x1e]);$(_0x59ca73(0x15a))[_0x59ca73(0x15f)](_0x59ca73(0x1a0)+_0x210667+',\x20'+_0x593c7a+',\x20'+_0x48c6ed+',\x20'+_0x485e35+',\x20'+_0x3ed38b+',\x20'+_0x14759f+',\x20'+_0x30ed40+',\x20'+excelDateToJSDate(_0x1161b1)+'</p>');}});},_0x1d9afa[_0x9239f(0x19d)](_0x263a1d);},excelDateToJSDate=_0x1b3bc6=>{const _0x4201b1=a0_0xe671cb,_0x5db092=_0x1b3bc6-0x63e1,_0xfdcee7=_0x5db092*0x15180,_0x3af2b5=new Date(_0xfdcee7*0x3e8),_0x4c25c1=String(_0x3af2b5[_0x4201b1(0x193)]())[_0x4201b1(0x189)](0x2,'0'),_0x1b162d=String(_0x3af2b5['getUTCMonth']()+0x1)[_0x4201b1(0x189)](0x2,'0'),_0x3f9c66=_0x3af2b5[_0x4201b1(0x167)]();return _0x4c25c1+'/'+_0x1b162d+'/'+_0x3f9c66;},getDocument=_0x4cd4b1=>{const _0x416377=a0_0xe671cb;return $('#resultContainerDownloadDates')[_0x416377(0x19c)]()[_0x416377(0x165)]===0x0&&$('#resultContainerDownloadDates')[_0x416377(0x15f)](_0x416377(0x144)),new Promise(_0x3df5df=>{const _0x4778b3=_0x416377;$['ajax']({'url':hostDocument,'type':_0x4778b3(0x150),'headers':{'repparams':getParams(_0x4cd4b1),'Authorization':_0x4778b3(0x14c)+getToken()},'xhrFields':{'responseType':_0x4778b3(0x18b)},'success':function(_0x33ee2b){const _0x4db2c5=_0x4778b3,_0x44857e=new FileReader();_0x44857e[_0x4db2c5(0x157)]=function(_0x1f680b){const _0x3d36e7=_0x4db2c5,_0x53dccd=new Uint8Array(_0x1f680b[_0x3d36e7(0x14a)][_0x3d36e7(0x181)]),_0x394acf=XLSX[_0x3d36e7(0x175)](_0x53dccd,{'type':_0x3d36e7(0x198)}),_0x41b150=_0x394acf[_0x3d36e7(0x18f)][0x0],_0x498940=_0x394acf['Sheets'][_0x41b150],_0x327425=XLSX[_0x3d36e7(0x152)]['sheet_to_json'](_0x498940,{'header':0x1});let _0x2a7d84=![],_0x4c51d4=[];_0x327425[_0x3d36e7(0x199)]((_0x51ad7c,_0x555c36)=>{const _0xd6c69b=_0x3d36e7;if(_0x555c36>0x0){const _0x2880ee=_0x51ad7c[0x1],_0x34a7ec=replaceAccents(_0x51ad7c[0x2]+'\x20'+_0x51ad7c[0x3]+'\x20'+_0x51ad7c[0x4]+'\x20'+_0x51ad7c[0x5]),_0x2ae6c6=_0x51ad7c[0x6],_0x156277=replaceAccents(_0x51ad7c[0x8]),_0x28bd4b=replaceAccents(_0x51ad7c[0x9]),_0x490af7=_0x51ad7c[0x14],_0x45f946=replaceAccents(_0x51ad7c[0x15]),_0x2d4bb7=excelDateToJSDate(_0x51ad7c[0x1e]);if(noImprimir['some'](_0x1aa22a=>_0x45f946[_0xd6c69b(0x16e)](_0x1aa22a[_0xd6c69b(0x160)]())))return;if(!_0x2880ee){$(_0xd6c69b(0x15a))['append'](_0xd6c69b(0x1a0)+_0x4cd4b1+_0xd6c69b(0x185)),_0x2a7d84=!![];return;}!_0x4c51d4[_0xd6c69b(0x16e)](_0x490af7)&&$(_0xd6c69b(0x15a))[_0xd6c69b(0x15f)](_0xd6c69b(0x1a0)+_0x2880ee+';\x20'+_0x34a7ec+';\x20'+_0x2ae6c6+';\x20'+_0x156277+';\x20'+_0x28bd4b+';\x20'+_0x490af7+';\x20'+_0x45f946+';\x20'+_0x2d4bb7+_0xd6c69b(0x168)),_0x4c51d4[_0xd6c69b(0x14b)](_0x490af7),_0x2a7d84=!![];}}),!_0x2a7d84&&$(_0x3d36e7(0x15a))[_0x3d36e7(0x15f)](_0x3d36e7(0x1a0)+_0x4cd4b1+_0x3d36e7(0x148));},_0x44857e['readAsArrayBuffer'](_0x33ee2b),_0x3df5df();},'error':function(_0x577e40){const _0x1fd51b=_0x4778b3;console[_0x1fd51b(0x195)]('Error\x20al\x20obtener\x20el\x20documento:',_0x577e40),_0x3df5df();}});});},exportResultContainerToCSV=_0x11fc18=>{const _0x5c89eb=a0_0xe671cb,_0x36615c=[];$(_0x5c89eb(0x15a))[_0x5c89eb(0x19c)]()[_0x5c89eb(0x153)](function(){const _0x13922c=_0x5c89eb,_0x477783=$(this)[_0x13922c(0x14f)]()[_0x13922c(0x162)]();_0x477783&&_0x36615c[_0x13922c(0x14b)](_0x477783);});const _0x1c6f17=_0x36615c['join']('\x0a'),_0x1e6d50=new Blob([_0x1c6f17],{'type':_0x5c89eb(0x142)}),_0x445e01=document[_0x5c89eb(0x15b)]('a'),_0x384dd9=URL['createObjectURL'](_0x1e6d50);_0x445e01['setAttribute']('href',_0x384dd9),_0x445e01['setAttribute']('download',_0x11fc18+'.csv'),_0x445e01[_0x5c89eb(0x164)][_0x5c89eb(0x179)]=_0x5c89eb(0x194),document[_0x5c89eb(0x18a)][_0x5c89eb(0x188)](_0x445e01),_0x445e01[_0x5c89eb(0x173)](),document[_0x5c89eb(0x18a)]['removeChild'](_0x445e01);},replaceAccents=_0x4f1dfd=>{const _0x33e96e=a0_0xe671cb;if(!_0x4f1dfd)return'';return _0x4f1dfd[_0x33e96e(0x1a1)](_0x33e96e(0x163))['replace'](/[\u0300-\u036f]/g,'');},processDates=_0x26acb4=>{const _0x36094c=a0_0xe671cb;return _0x26acb4[_0x36094c(0x174)](_0x86974e=>{const _0x2c537a=_0x36094c,_0x3c12a9=_0x86974e[_0x2c537a(0x190)]('/');if(_0x3c12a9['length']!==0x3)return _0x2c537a(0x17d);let [_0x5a0494,_0x15d303,_0xc5ef1a]=_0x3c12a9['map'](_0x538cac=>parseInt(_0x538cac,0xa));if(_0x15d303>0xc)return _0x15d303+'/'+_0x5a0494+'/'+_0xc5ef1a;return _0x5a0494+'/'+_0x15d303+'/'+_0xc5ef1a;});};$(a0_0xe671cb(0x154))['on']('submit',async function(_0x269199){const _0x1f55e0=a0_0xe671cb;_0x269199[_0x1f55e0(0x184)](),showSpinner(),$(_0x1f55e0(0x147))['empty']();let _0x16a0f1=$('#dates')[_0x1f55e0(0x192)]()[_0x1f55e0(0x143)](/[\n\r]+/g,',')['split'](',');_0x16a0f1=_0x16a0f1['map'](_0x5a68fa=>_0x5a68fa[_0x1f55e0(0x162)]()),_0x16a0f1=_0x16a0f1[_0x1f55e0(0x17a)](_0x4edfef=>_0x4edfef!=='');const _0x591dbe=processDates(_0x16a0f1);_0x591dbe['forEach'](_0x22dd61=>{const _0x5b7556=_0x1f55e0;$(_0x5b7556(0x147))[_0x5b7556(0x15f)](_0x22dd61+_0x5b7556(0x183));}),$('#resultContainerFormatDatesCard')[_0x1f55e0(0x196)](_0x1f55e0(0x158)),hideSpinner();});