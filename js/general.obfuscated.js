const a0_0x377071=a0_0x1361;(function(_0x157a9f,_0x376419){const _0x1ca360=a0_0x1361,_0x52e082=_0x157a9f();while(!![]){try{const _0x642bc=-parseInt(_0x1ca360(0x1fb))/0x1*(-parseInt(_0x1ca360(0x20b))/0x2)+parseInt(_0x1ca360(0x24b))/0x3*(parseInt(_0x1ca360(0x1e9))/0x4)+parseInt(_0x1ca360(0x22d))/0x5+-parseInt(_0x1ca360(0x22f))/0x6*(-parseInt(_0x1ca360(0x1fc))/0x7)+-parseInt(_0x1ca360(0x1fa))/0x8+-parseInt(_0x1ca360(0x1f5))/0x9+-parseInt(_0x1ca360(0x1eb))/0xa;if(_0x642bc===_0x376419)break;else _0x52e082['push'](_0x52e082['shift']());}catch(_0x40bdce){_0x52e082['push'](_0x52e082['shift']());}}}(a0_0x21c6,0xe90ec));const hostLogin=a0_0x377071(0x1ed),dataLogin={'oidUsuario':0x1,'oidCentroAtencion':0x1},hostDocument=a0_0x377071(0x218),hostFolio=a0_0x377071(0x23a);let allData=[];const noPrintEspecialidad=[a0_0x377071(0x234)],noPrintDiagnostico=[a0_0x377071(0x21c)],noImprimir=['CONSULTA\x20EXTERNA','URGENCIAS','TRIAGE'],showSpinner=()=>{const _0x44b03f=a0_0x377071;$(_0x44b03f(0x233))[_0x44b03f(0x1f6)](_0x44b03f(0x205));},hideSpinner=()=>{const _0x194bba=a0_0x377071;$(_0x194bba(0x233))[_0x194bba(0x229)](_0x194bba(0x205));};$(a0_0x377071(0x212))['on'](a0_0x377071(0x20d),function(){const _0x73eb3a=a0_0x377071;$(this)[_0x73eb3a(0x1fe)]()[_0x73eb3a(0x226)](_0x73eb3a(0x201))[_0x73eb3a(0x202)](''),$(this)['parent']()[_0x73eb3a(0x226)](_0x73eb3a(0x224))[_0x73eb3a(0x202)](''),$(_0x73eb3a(0x222))[_0x73eb3a(0x229)](_0x73eb3a(0x205));}),$(a0_0x377071(0x1ef))['on'](a0_0x377071(0x201),function(){const _0x28e9f7=a0_0x377071,_0x627424=/^[0-9,\s]*$/;let _0x315ce1=$(this)[_0x28e9f7(0x202)]();_0x315ce1=_0x315ce1['replace'](/[\n\r]+/g,','),!_0x627424['test'](_0x315ce1)&&(_0x315ce1=_0x315ce1['replace'](/[^0-9,\s,]/g,'')),$(this)[_0x28e9f7(0x202)](_0x315ce1);}),$(a0_0x377071(0x1f1))['on'](a0_0x377071(0x217),async function(_0x63e080){const _0x3e5327=a0_0x377071;_0x63e080[_0x3e5327(0x22b)](),$(_0x3e5327(0x209))['empty'](),allData=[];let _0x30b1c2=$('#documents')[_0x3e5327(0x202)]()[_0x3e5327(0x216)](',');_0x30b1c2=_0x30b1c2['map'](_0xe7ad2f=>_0xe7ad2f[_0x3e5327(0x22e)]()),_0x30b1c2[_0x3e5327(0x21e)]((_0x400e19,_0x224685)=>_0x400e19-_0x224685),_0x30b1c2=[...new Set(_0x30b1c2)],_0x30b1c2=_0x30b1c2[_0x3e5327(0x220)](_0x1814fb=>_0x1814fb!==''&&_0x1814fb[_0x3e5327(0x23f)]>0x0);if(_0x30b1c2[_0x3e5327(0x23f)]===0x0){alert('No\x20se\x20encontraron\x20documentos\x20válidos.');return;}showSpinner();try{await Promise[_0x3e5327(0x223)](_0x30b1c2[_0x3e5327(0x1ff)](_0x52afdd=>getDocument(_0x52afdd))),$(_0x3e5327(0x1f7))[_0x3e5327(0x1f6)](_0x3e5327(0x205)),hideSpinner();}catch(_0x18add3){console['error'](_0x3e5327(0x23d),_0x18add3),hideSpinner();}}),$('#downloadCSV')['on']('click',function(){const _0x14825c=a0_0x377071;if($(_0x14825c(0x209))[_0x14825c(0x227)]()[_0x14825c(0x23f)]===0x0){alert('No\x20hay\x20datos\x20para\x20descargar.');return;}exportResultContainerToCSV(_0x14825c(0x1f3));});const getToken=()=>{const _0x2f35c8=a0_0x377071;if(localStorage[_0x2f35c8(0x23e)](_0x2f35c8(0x249)))return localStorage[_0x2f35c8(0x23e)](_0x2f35c8(0x249));$[_0x2f35c8(0x231)]({'url':hostLogin,'type':'POST','contentType':_0x2f35c8(0x219),'data':JSON[_0x2f35c8(0x1ea)](dataLogin),'success':function(_0x37cdad){const _0x2a6243=_0x2f35c8,_0x3f0ec6=_0x37cdad[_0x2a6243(0x249)];return localStorage['setItem']('token',_0x3f0ec6),_0x3f0ec6;},'error':function(_0x8e899){const _0x657029=_0x2f35c8;return console[_0x657029(0x237)](_0x657029(0x1ee),_0x8e899),null;}});},getParams=_0x47c6c1=>{const _0x46a6ef=a0_0x377071;return encodeURIComponent(JSON[_0x46a6ef(0x1ea)]({'Nombre':_0x46a6ef(0x228),'Descripcion':_0x46a6ef(0x228),'SentenciaSQL':'','Estado':'Activo','Parametros':[{'Nombre':_0x46a6ef(0x20a),'Campo':_0x46a6ef(0x232),'Tipo':_0x46a6ef(0x207),'DbNombre':_0x46a6ef(0x20a),'DbNombreCompleto':_0x46a6ef(0x246),'DbTamano':0x1e,'DbTipo':_0x46a6ef(0x207),'Valor':_0x47c6c1,'Oid':0x1,'IdBloqueo':null,'RegistroEliminado':![],'OidResult':null}],'formato':'XLSX\x20PLANO','SerializadoXml':!![],'Oid':0x1a,'IdBloqueo':null,'RegistroEliminado':![],'OidResult':null}));},readExcelFromBlob=_0x10731e=>{const _0x4cfcd3=a0_0x377071,_0x5b2f08=new FileReader();_0x5b2f08[_0x4cfcd3(0x213)]=function(_0x30df15){const _0x59f708=_0x4cfcd3,_0x4ed99e=new Uint8Array(_0x30df15[_0x59f708(0x236)][_0x59f708(0x211)]),_0x2e7b81=XLSX[_0x59f708(0x24e)](_0x4ed99e,{'type':_0x59f708(0x24a)}),_0x2c0548=_0x2e7b81[_0x59f708(0x214)][0x0],_0x3a732c=_0x2e7b81[_0x59f708(0x23b)][_0x2c0548],_0x2beb4a=XLSX[_0x59f708(0x1f4)][_0x59f708(0x1f8)](_0x3a732c,{'header':0x1});_0x2beb4a[_0x59f708(0x239)]((_0x4c172f,_0x4f59a7)=>{const _0x4a3dd8=_0x59f708;if(_0x4f59a7>0x0){let _0xf0caa0=_0x4c172f[0x1],_0x3048e2=_0x4c172f[0x2]+'\x20'+_0x4c172f[0x3]+'\x20'+_0x4c172f[0x4]+'\x20'+_0x4c172f[0x5],_0x2c82a2=_0x4c172f[0x6],_0x813d59=_0x4c172f[0x8],_0xabd4a1=_0x4c172f[0x9],_0x460fe7=_0x4c172f[0x14],_0x51a856=_0x4c172f[0x15],_0x5dac4a=excelDateToJSDate(_0x4c172f[0x1e]);$(_0x4a3dd8(0x209))['append'](_0x4a3dd8(0x238)+_0xf0caa0+',\x20'+_0x3048e2+',\x20'+_0x2c82a2+',\x20'+_0x813d59+',\x20'+_0xabd4a1+',\x20'+_0x460fe7+',\x20'+_0x51a856+',\x20'+excelDateToJSDate(_0x5dac4a)+_0x4a3dd8(0x20e));}});},_0x5b2f08['readAsArrayBuffer'](_0x10731e);},excelDateToJSDate=_0xe64c9f=>{const _0x518451=a0_0x377071,_0x35bed3=_0xe64c9f-0x63e1,_0x40b3a4=_0x35bed3*0x15180,_0x3da781=new Date(_0x40b3a4*0x3e8),_0x298e73=String(_0x3da781[_0x518451(0x242)]())[_0x518451(0x243)](0x2,'0'),_0x24604a=String(_0x3da781[_0x518451(0x200)]()+0x1)[_0x518451(0x243)](0x2,'0'),_0x35cfa4=_0x3da781[_0x518451(0x225)]();return _0x298e73+'/'+_0x24604a+'/'+_0x35cfa4;},getDocument=_0x3b6548=>{const _0x359489=a0_0x377071;return $(_0x359489(0x209))[_0x359489(0x227)]()[_0x359489(0x23f)]===0x0&&$('#resultContainerDownloadDates')[_0x359489(0x1ec)](_0x359489(0x230)),new Promise(_0x8750c5=>{const _0x40e092=_0x359489;$[_0x40e092(0x231)]({'url':hostDocument,'type':_0x40e092(0x22a),'headers':{'repparams':getParams(_0x3b6548),'Authorization':_0x40e092(0x1f2)+getToken()},'xhrFields':{'responseType':_0x40e092(0x24c)},'success':function(_0x1d0933){const _0x5c9c13=_0x40e092,_0x1fbc61=new FileReader();_0x1fbc61['onload']=function(_0x48b8d5){const _0x2b8a93=a0_0x1361,_0x16a5f2=new Uint8Array(_0x48b8d5[_0x2b8a93(0x236)][_0x2b8a93(0x211)]),_0x25e278=XLSX['read'](_0x16a5f2,{'type':'array'}),_0x12ca4a=_0x25e278['SheetNames'][0x0],_0x2b643e=_0x25e278[_0x2b8a93(0x23b)][_0x12ca4a],_0x50aa67=XLSX[_0x2b8a93(0x1f4)][_0x2b8a93(0x1f8)](_0x2b643e,{'header':0x1});let _0x289b44=![],_0x351e55=[];_0x50aa67[_0x2b8a93(0x239)]((_0x76ca0b,_0xa680d7)=>{const _0x516e58=_0x2b8a93;if(_0xa680d7>0x0){const _0x120cf2=_0x76ca0b[0x1],_0x518ff9=replaceAccents(_0x76ca0b[0x2]+'\x20'+_0x76ca0b[0x3]+'\x20'+_0x76ca0b[0x4]+'\x20'+_0x76ca0b[0x5]),_0x32f542=_0x76ca0b[0x6],_0x25a783=replaceAccents(_0x76ca0b[0x8]),_0x3c0649=replaceAccents(_0x76ca0b[0x9]),_0x348ce5=_0x76ca0b[0x14],_0xaa9826=replaceAccents(_0x76ca0b[0x15]),_0x5c773f=excelDateToJSDate(_0x76ca0b[0x1e]);if(noImprimir['some'](_0x5c5b71=>_0xaa9826[_0x516e58(0x244)](_0x5c5b71[_0x516e58(0x21f)]())))return;if(!_0x120cf2){$(_0x516e58(0x209))[_0x516e58(0x1ec)](_0x516e58(0x238)+_0x3b6548+_0x516e58(0x210)),_0x289b44=!![];return;}!_0x351e55[_0x516e58(0x244)](_0x348ce5)&&$(_0x516e58(0x209))[_0x516e58(0x1ec)]('<p>'+_0x120cf2+';\x20'+_0x518ff9+';\x20'+_0x32f542+';\x20'+_0x25a783+';\x20'+_0x3c0649+';\x20'+_0x348ce5+';\x20'+_0xaa9826+';\x20'+_0x5c773f+_0x516e58(0x20e)),_0x351e55['push'](_0x348ce5),_0x289b44=!![];}}),!_0x289b44&&$(_0x2b8a93(0x209))['append'](_0x2b8a93(0x238)+_0x3b6548+';\x20sin\x20PM</p>');},_0x1fbc61[_0x5c9c13(0x248)](_0x1d0933),_0x8750c5();},'error':function(_0x3e58f4){const _0x2d22fd=_0x40e092;console['error'](_0x2d22fd(0x203),_0x3e58f4),_0x8750c5();}});});},exportResultContainerToCSV=_0x46ad0b=>{const _0x542218=a0_0x377071,_0x74a9fe=[];$('#resultContainerDownloadDates')[_0x542218(0x227)]()[_0x542218(0x20f)](function(){const _0x3e6a53=_0x542218,_0x3e03f1=$(this)[_0x3e6a53(0x206)]()[_0x3e6a53(0x22e)]();_0x3e03f1&&_0x74a9fe[_0x3e6a53(0x1f0)](_0x3e03f1);});const _0x10b16c=_0x74a9fe['join']('\x0a'),_0x2bd5c3=new Blob([_0x10b16c],{'type':_0x542218(0x21b)}),_0x24dc59=document['createElement']('a'),_0x34bc75=URL[_0x542218(0x23c)](_0x2bd5c3);_0x24dc59[_0x542218(0x1fd)](_0x542218(0x21a),_0x34bc75),_0x24dc59[_0x542218(0x1fd)](_0x542218(0x208),_0x46ad0b+_0x542218(0x247)),_0x24dc59[_0x542218(0x24d)][_0x542218(0x1f9)]='hidden',document['body']['appendChild'](_0x24dc59),_0x24dc59[_0x542218(0x20d)](),document['body'][_0x542218(0x20c)](_0x24dc59);},replaceAccents=_0x1b8d50=>{const _0x325234=a0_0x377071;if(!_0x1b8d50)return'';return _0x1b8d50[_0x325234(0x221)](_0x325234(0x241))[_0x325234(0x21d)](/[\u0300-\u036f]/g,'');};function a0_0x21c6(){const _0x24888d=['#spinner','ODONTOLOGIA\x20GENERAL','empty','target','error','<p>','forEach','https://citas.usiese.gov.co:6007/api/HistoriaClinica/HistoriaClinicaConsulta/ObtenerHistoricoFolios/?oidIngreso=0&directivas=true&hcUnificada=false&id=','Sheets','createObjectURL','Error\x20al\x20procesar\x20los\x20documentos:','getItem','length','#resultContainerFormatDates','NFD','getUTCDate','padStart','includes','#formFormatDates','@DOCUMENTO','.csv','readAsArrayBuffer','token','array','609HrluVC','blob','style','read','1420MLAccw','stringify','18263050OdQOXg','append','https://citas.usiese.gov.co:6007/api/Generales/ApiGeSeguridad/IniciarSesionCentroAtencion','Error\x20al\x20obtener\x20el\x20token:','#documents','push','#formDownloadDates','Bearer\x20','Resultado.csv','utils','4726746yYnsbe','removeClass','#resultContainerDownloadDatesCard','sheet_to_json','visibility','4095352nUPMjH','1NfoxbN','1295VIXZcu','setAttribute','parent','map','getUTCMonth','input','val','Error\x20al\x20obtener\x20el\x20documento:','#resultContainerFormatDatesCard','d-none','text','String','download','#resultContainerDownloadDates','DOCUMENTO','3726146YxWCpf','removeChild','click','</p>','each',';\x20sin\x20citas</p>','result','.clean','onload','SheetNames','</br>','split','submit','https://citas.usiese.gov.co:6007/api/Generales/ApiGeReporteGenerado/ExportarReporte','application/json','href','text/csv;charset=utf-8;','CARIES\x20DE\x20LA\x20DENTINA','replace','sort','toUpperCase','filter','normalize','.results','all','textarea','getUTCFullYear','find','children','SERVICIOS\x20PRESTADOS\x20A\x20PACIENTES','addClass','GET','preventDefault','#dates','7554245nOmbLj','trim','12066kNKXha','<p><b>PACNUMDOC;\x20NOMBRE;\x20SEXO;\x20EDAD_ACTUAL;\x20EDAD_SERVICIO;\x20SIPCODIGO;\x20SIPNOMBRE;\x20SERFECSER</b></p>','ajax','GENPACIEN.PACNUMDOC\x20='];a0_0x21c6=function(){return _0x24888d;};return a0_0x21c6();}$(a0_0x377071(0x245))['on'](a0_0x377071(0x217),async function(_0x1f39c5){const _0x4aba1b=a0_0x377071;_0x1f39c5[_0x4aba1b(0x22b)](),showSpinner(),$(_0x4aba1b(0x240))['empty'](),dates[_0x4aba1b(0x1ff)](_0x539b74=>{const _0x5eaa0c=_0x4aba1b,_0x5e6f4b=_0x539b74[_0x5eaa0c(0x216)]('/');if(_0x5e6f4b[_0x5eaa0c(0x23f)]!==0x3)return'Fecha\x20inválida';let [_0x4f9efc,_0x17b323,_0x19927e]=_0x5e6f4b[_0x5eaa0c(0x1ff)](_0x175cb0=>parseInt(_0x175cb0,0xa));if(_0x4f9efc>0xc)return String(_0x4f9efc)[_0x5eaa0c(0x243)](0x2,'0')+'/'+String(_0x17b323)[_0x5eaa0c(0x243)](0x2,'0')+'/'+_0x19927e;return String(_0x17b323)[_0x5eaa0c(0x243)](0x2,'0')+'/'+String(_0x4f9efc)[_0x5eaa0c(0x243)](0x2,'0')+'/'+_0x19927e;}),hideSpinner();});const processDates=_0x13de6a=>{const _0x2ea941=a0_0x377071;return _0x13de6a[_0x2ea941(0x1ff)](_0x2bbcff=>{const _0x300309=_0x2ea941,_0x3bffc3=_0x2bbcff['split']('/');if(_0x3bffc3['length']!==0x3)return'Fecha\x20inválida';let [_0x3a99b7,_0x40c6ce,_0x5091d3]=_0x3bffc3[_0x300309(0x1ff)](_0x210842=>parseInt(_0x210842,0xa));if(_0x3a99b7>0xc)return String(_0x3a99b7)[_0x300309(0x243)](0x2)+'/'+String(_0x40c6ce)['padStart'](0x2)+'/'+_0x5091d3;return String(_0x40c6ce)[_0x300309(0x243)](0x2)+'/'+String(_0x3a99b7)[_0x300309(0x243)](0x2)+'/'+_0x5091d3;});};function a0_0x1361(_0x5eb5a6,_0x2dac66){const _0x21c6a3=a0_0x21c6();return a0_0x1361=function(_0x136174,_0x56228b){_0x136174=_0x136174-0x1e9;let _0x27979b=_0x21c6a3[_0x136174];return _0x27979b;},a0_0x1361(_0x5eb5a6,_0x2dac66);}$(a0_0x377071(0x245))['on'](a0_0x377071(0x217),async function(_0x55aae8){const _0x53c88d=a0_0x377071;_0x55aae8['preventDefault'](),showSpinner(),$('#resultContainerFormatDates')[_0x53c88d(0x235)]();let _0x3815af=$(_0x53c88d(0x22c))[_0x53c88d(0x202)]()[_0x53c88d(0x21d)](/[\n\r]+/g,',')['split'](',');_0x3815af=_0x3815af[_0x53c88d(0x1ff)](_0x31d596=>_0x31d596[_0x53c88d(0x22e)]()),_0x3815af=_0x3815af[_0x53c88d(0x220)](_0x156a0f=>_0x156a0f!=='');const _0x42a8c3=processDates(_0x3815af);_0x42a8c3[_0x53c88d(0x239)](_0x2d625b=>{const _0xd4156a=_0x53c88d;$(_0xd4156a(0x240))[_0xd4156a(0x1ec)](_0x2d625b+_0xd4156a(0x215));}),$(_0x53c88d(0x204))[_0x53c88d(0x1f6)]('d-none'),hideSpinner();});