const a0_0x4e0690=a0_0x3ce3;(function(_0x1944cb,_0x55206a){const _0x5087b9=a0_0x3ce3,_0xe32be2=_0x1944cb();while(!![]){try{const _0x31095d=parseInt(_0x5087b9(0x209))/0x1+parseInt(_0x5087b9(0x217))/0x2+parseInt(_0x5087b9(0x239))/0x3+parseInt(_0x5087b9(0x238))/0x4*(-parseInt(_0x5087b9(0x207))/0x5)+parseInt(_0x5087b9(0x21d))/0x6*(-parseInt(_0x5087b9(0x237))/0x7)+parseInt(_0x5087b9(0x243))/0x8*(-parseInt(_0x5087b9(0x23d))/0x9)+-parseInt(_0x5087b9(0x230))/0xa*(-parseInt(_0x5087b9(0x227))/0xb);if(_0x31095d===_0x55206a)break;else _0xe32be2['push'](_0xe32be2['shift']());}catch(_0x37f383){_0xe32be2['push'](_0xe32be2['shift']());}}}(a0_0xf871,0xca282));const hostLogin=a0_0x4e0690(0x20a),dataLogin={'oidUsuario':0x1,'oidCentroAtencion':0x1},hostDocument=a0_0x4e0690(0x1fb),hostFolio=a0_0x4e0690(0x202);let allData=[];function a0_0x3ce3(_0x4a19d2,_0x4cc503){const _0xf871a=a0_0xf871();return a0_0x3ce3=function(_0x3ce302,_0x5e248f){_0x3ce302=_0x3ce302-0x1ee;let _0xc6eb56=_0xf871a[_0x3ce302];return _0xc6eb56;},a0_0x3ce3(_0x4a19d2,_0x4cc503);}const noPrintEspecialidad=[a0_0x4e0690(0x22c)],noPrintDiagnostico=[a0_0x4e0690(0x219)],noImprimir=[a0_0x4e0690(0x218),a0_0x4e0690(0x21f),a0_0x4e0690(0x220)],showSpinner=()=>{const _0x162da2=a0_0x4e0690;$(_0x162da2(0x22e))['removeClass'](_0x162da2(0x223));},hideSpinner=()=>{const _0x565634=a0_0x4e0690;$(_0x565634(0x22e))[_0x565634(0x23f)](_0x565634(0x223));};$(a0_0x4e0690(0x20b))['on'](a0_0x4e0690(0x1f8),function(){const _0x4b6e28=a0_0x4e0690,_0x27e5bf=/^[0-9,\s]*$/;let _0x3572d3=$(this)['val']();_0x3572d3=_0x3572d3['replace'](/[\n\r]+/g,','),!_0x27e5bf[_0x4b6e28(0x21c)](_0x3572d3)&&(_0x3572d3=_0x3572d3[_0x4b6e28(0x23c)](/[^0-9,\s,]/g,'')),$(this)['val'](_0x3572d3);}),$(a0_0x4e0690(0x206))['on'](a0_0x4e0690(0x1ff),async function(_0x2b484c){const _0x3fdb90=a0_0x4e0690;_0x2b484c[_0x3fdb90(0x211)](),$(_0x3fdb90(0x22d))[_0x3fdb90(0x22b)](),allData=[];let _0x23a4da=$(_0x3fdb90(0x20b))['val']()[_0x3fdb90(0x1ee)](',');_0x23a4da=_0x23a4da['map'](_0x1def37=>_0x1def37['trim']()),_0x23a4da['sort']((_0xc797a5,_0x4f6a48)=>_0xc797a5-_0x4f6a48),_0x23a4da=[...new Set(_0x23a4da)],_0x23a4da=_0x23a4da[_0x3fdb90(0x203)](_0x3ec1e7=>_0x3ec1e7!==''&&_0x3ec1e7[_0x3fdb90(0x201)]>0x0);if(_0x23a4da[_0x3fdb90(0x201)]===0x0){alert('No\x20se\x20encontraron\x20documentos\x20vÃ¡lidos.');return;}showSpinner();try{await Promise[_0x3fdb90(0x242)](_0x23a4da[_0x3fdb90(0x225)](_0x324759=>getDocument(_0x324759))),hideSpinner();}catch(_0x260d19){console['error'](_0x3fdb90(0x21a),_0x260d19),hideSpinner();}}),$(a0_0x4e0690(0x213))['on']('click',function(){const _0x1173a1=a0_0x4e0690;if($('#resultContainer')[_0x1173a1(0x1ef)]()[_0x1173a1(0x201)]===0x0){alert('No\x20hay\x20datos\x20para\x20descargar.');return;}exportResultContainerToCSV(_0x1173a1(0x229));});function a0_0xf871(){const _0x33296a=['includes','input','target','Error\x20al\x20obtener\x20el\x20token:','https://citas.usiese.gov.co:6007/api/Generales/ApiGeReporteGenerado/ExportarReporte','append','setItem',';\x20sin\x20PM</p>','submit','result','length','https://citas.usiese.gov.co:6007/api/HistoriaClinica/HistoriaClinicaConsulta/ObtenerHistoricoFolios/?oidIngreso=0&directivas=true&hcUnificada=false&id=','filter','XLSX\x20PLANO','visibility','#formDocuments','1989400NGyzDA','<p>','175865bXVLtY','https://citas.usiese.gov.co:6007/api/Generales/ApiGeSeguridad/IniciarSesionCentroAtencion','#documents','read','array','getUTCFullYear','href','Error\x20al\x20obtener\x20el\x20documento:','preventDefault','toUpperCase','#downloadCSV','ajax','each','SERVICIOS\x20PRESTADOS\x20A\x20PACIENTES','359518GncstV','CONSULTA\x20EXTERNA','CARIES\x20DE\x20LA\x20DENTINA','Error\x20al\x20procesar\x20los\x20documentos:','forEach','test','32940EKRZQx','body','URGENCIAS','TRIAGE','normalize','removeChild','d-none','NFD','map','setAttribute','33qUvUEY','getUTCMonth','Resultado.csv','stringify','empty','ODONTOLOGIA\x20GENERAL','#resultContainer','#spinner','Activo','7454960JvKvTR','onload','text/csv;charset=utf-8;','Bearer\x20','blob','createObjectURL','POST','1484tchstU','12pyjPJf','2291247FFpUom','push','some','replace','9goxYHN','application/json','addClass','style','token','all','1362456QmBzYU','.csv','join','String','DOCUMENTO','readAsArrayBuffer','text','split','children','trim','Sheets','hidden','</p>',';\x20sin\x20citas</p>','sheet_to_json','padStart'];a0_0xf871=function(){return _0x33296a;};return a0_0xf871();}const getToken=()=>{const _0x74aa95=a0_0x4e0690;if(localStorage['getItem']('token'))return localStorage['getItem'](_0x74aa95(0x241));$[_0x74aa95(0x214)]({'url':hostLogin,'type':_0x74aa95(0x236),'contentType':_0x74aa95(0x23e),'data':JSON['stringify'](dataLogin),'success':function(_0x197c21){const _0x112f58=_0x74aa95,_0x39bc80=_0x197c21['token'];return localStorage[_0x112f58(0x1fd)](_0x112f58(0x241),_0x39bc80),_0x39bc80;},'error':function(_0x548ba5){const _0x5cbf91=_0x74aa95;return console['error'](_0x5cbf91(0x1fa),_0x548ba5),null;}});},getParams=_0x4c6828=>{const _0x1dc685=a0_0x4e0690;return encodeURIComponent(JSON[_0x1dc685(0x22a)]({'Nombre':_0x1dc685(0x216),'Descripcion':_0x1dc685(0x216),'SentenciaSQL':'','Estado':_0x1dc685(0x22f),'Parametros':[{'Nombre':'DOCUMENTO','Campo':'GENPACIEN.PACNUMDOC\x20=','Tipo':_0x1dc685(0x246),'DbNombre':_0x1dc685(0x247),'DbNombreCompleto':'@DOCUMENTO','DbTamano':0x1e,'DbTipo':_0x1dc685(0x246),'Valor':_0x4c6828,'Oid':0x1,'IdBloqueo':null,'RegistroEliminado':![],'OidResult':null}],'formato':_0x1dc685(0x204),'SerializadoXml':!![],'Oid':0x1a,'IdBloqueo':null,'RegistroEliminado':![],'OidResult':null}));},readExcelFromBlob=_0x246774=>{const _0x16297c=a0_0x4e0690,_0x5684f3=new FileReader();_0x5684f3[_0x16297c(0x231)]=function(_0x17feff){const _0x240934=_0x16297c,_0xfbb6cf=new Uint8Array(_0x17feff[_0x240934(0x1f9)][_0x240934(0x200)]),_0x505833=XLSX[_0x240934(0x20c)](_0xfbb6cf,{'type':_0x240934(0x20d)}),_0x5d3a1e=_0x505833['SheetNames'][0x0],_0x3e69a0=_0x505833['Sheets'][_0x5d3a1e],_0x5205d3=XLSX['utils'][_0x240934(0x1f5)](_0x3e69a0,{'header':0x1});_0x5205d3[_0x240934(0x21b)]((_0x388ae4,_0x180b29)=>{const _0x561d4e=_0x240934;if(_0x180b29>0x0){let _0xe8b228=_0x388ae4[0x1],_0x443a1d=_0x388ae4[0x2]+'\x20'+_0x388ae4[0x3]+'\x20'+_0x388ae4[0x4]+'\x20'+_0x388ae4[0x5],_0x2325d0=_0x388ae4[0x6],_0x3390b9=_0x388ae4[0x8],_0x5ca743=_0x388ae4[0x9],_0x294e31=_0x388ae4[0x14],_0x379c6b=_0x388ae4[0x15],_0xd249a=excelDateToJSDate(_0x388ae4[0x1e]);$(_0x561d4e(0x22d))[_0x561d4e(0x1fc)](_0x561d4e(0x208)+_0xe8b228+',\x20'+_0x443a1d+',\x20'+_0x2325d0+',\x20'+_0x3390b9+',\x20'+_0x5ca743+',\x20'+_0x294e31+',\x20'+_0x379c6b+',\x20'+excelDateToJSDate(_0xd249a)+_0x561d4e(0x1f3));}});},_0x5684f3[_0x16297c(0x248)](_0x246774);},excelDateToJSDate=_0x466441=>{const _0x33061b=a0_0x4e0690,_0x191a8d=_0x466441-0x63e1,_0x3d96b5=_0x191a8d*0x15180,_0x1d6ad2=new Date(_0x3d96b5*0x3e8),_0x4fc4f6=String(_0x1d6ad2['getUTCDate']())[_0x33061b(0x1f6)](0x2,'0'),_0x544bc4=String(_0x1d6ad2[_0x33061b(0x228)]()+0x1)[_0x33061b(0x1f6)](0x2,'0'),_0x5de934=_0x1d6ad2[_0x33061b(0x20e)]();return _0x4fc4f6+'/'+_0x544bc4+'/'+_0x5de934;},getDocument=_0x41dc4e=>{const _0x4f5daf=a0_0x4e0690;return $(_0x4f5daf(0x22d))[_0x4f5daf(0x1ef)]()[_0x4f5daf(0x201)]===0x0&&$(_0x4f5daf(0x22d))['append']('<p><b>PACNUMDOC;\x20NOMBRE;\x20SEXO;\x20EDAD_ACTUAL;\x20EDAD_SERVICIO;\x20SIPCODIGO;\x20SIPNOMBRE;\x20SERFECSER</b></p>'),new Promise(_0x1907b4=>{const _0x4bafd=_0x4f5daf;$[_0x4bafd(0x214)]({'url':hostDocument,'type':'GET','headers':{'repparams':getParams(_0x41dc4e),'Authorization':_0x4bafd(0x233)+getToken()},'xhrFields':{'responseType':_0x4bafd(0x234)},'success':function(_0x2ff55c){const _0x2efcfb=_0x4bafd,_0x5e6472=new FileReader();_0x5e6472[_0x2efcfb(0x231)]=function(_0x96351f){const _0x3c6f99=_0x2efcfb,_0x54d2d0=new Uint8Array(_0x96351f[_0x3c6f99(0x1f9)][_0x3c6f99(0x200)]),_0x3f69d6=XLSX['read'](_0x54d2d0,{'type':_0x3c6f99(0x20d)}),_0x5efb44=_0x3f69d6['SheetNames'][0x0],_0x29fe5c=_0x3f69d6[_0x3c6f99(0x1f1)][_0x5efb44],_0x1abd8d=XLSX['utils'][_0x3c6f99(0x1f5)](_0x29fe5c,{'header':0x1});let _0x5cca39=![];_0x1abd8d[_0x3c6f99(0x21b)]((_0x3f32af,_0x2dfd4f)=>{const _0x597ced=_0x3c6f99;if(_0x2dfd4f>0x0){const _0x3ca852=_0x3f32af[0x1],_0x29ee2d=replaceAccents(_0x3f32af[0x2]+'\x20'+_0x3f32af[0x3]+'\x20'+_0x3f32af[0x4]+'\x20'+_0x3f32af[0x5]),_0x3981d4=_0x3f32af[0x6],_0x3421c2=replaceAccents(_0x3f32af[0x8]),_0x1f93d6=replaceAccents(_0x3f32af[0x9]),_0x51aaa5=_0x3f32af[0x14],_0x197ad8=replaceAccents(_0x3f32af[0x15]),_0x4c1ed8=excelDateToJSDate(_0x3f32af[0x1e]);if(noImprimir[_0x597ced(0x23b)](_0x38c923=>_0x197ad8[_0x597ced(0x1f7)](_0x38c923[_0x597ced(0x212)]())))return;if(!_0x3ca852){$('#resultContainer')[_0x597ced(0x1fc)](_0x597ced(0x208)+_0x41dc4e+_0x597ced(0x1f4)),_0x5cca39=!![];return;}$(_0x597ced(0x22d))[_0x597ced(0x1fc)](_0x597ced(0x208)+_0x3ca852+';\x20'+_0x29ee2d+';\x20'+_0x3981d4+';\x20'+_0x3421c2+';\x20'+_0x1f93d6+';\x20'+_0x51aaa5+';\x20'+_0x197ad8+';\x20'+_0x4c1ed8+_0x597ced(0x1f3)),_0x5cca39=!![];}}),!_0x5cca39&&$('#resultContainer')[_0x3c6f99(0x1fc)](_0x3c6f99(0x208)+_0x41dc4e+_0x3c6f99(0x1fe));},_0x5e6472[_0x2efcfb(0x248)](_0x2ff55c),_0x1907b4();},'error':function(_0x297384){const _0x4274ea=_0x4bafd;console['error'](_0x4274ea(0x210),_0x297384),_0x1907b4();}});});},exportResultContainerToCSV=_0x54486e=>{const _0x3a9afb=a0_0x4e0690,_0x4f882a=[];$(_0x3a9afb(0x22d))['children']()[_0x3a9afb(0x215)](function(){const _0x534b6b=_0x3a9afb,_0xeac24f=$(this)[_0x534b6b(0x249)]()[_0x534b6b(0x1f0)]();_0xeac24f&&_0x4f882a[_0x534b6b(0x23a)](_0xeac24f);});const _0x19f1f5=_0x4f882a[_0x3a9afb(0x245)]('\x0a'),_0x3585ad=new Blob([_0x19f1f5],{'type':_0x3a9afb(0x232)}),_0x223083=document['createElement']('a'),_0x5f1dc6=URL[_0x3a9afb(0x235)](_0x3585ad);_0x223083[_0x3a9afb(0x226)](_0x3a9afb(0x20f),_0x5f1dc6),_0x223083['setAttribute']('download',_0x54486e+_0x3a9afb(0x244)),_0x223083[_0x3a9afb(0x240)][_0x3a9afb(0x205)]=_0x3a9afb(0x1f2),document[_0x3a9afb(0x21e)]['appendChild'](_0x223083),_0x223083['click'](),document[_0x3a9afb(0x21e)][_0x3a9afb(0x222)](_0x223083);},replaceAccents=_0x28cd80=>{const _0x153e38=a0_0x4e0690;if(!_0x28cd80)return'';return _0x28cd80[_0x153e38(0x221)](_0x153e38(0x224))[_0x153e38(0x23c)](/[\u0300-\u036f]/g,'');};