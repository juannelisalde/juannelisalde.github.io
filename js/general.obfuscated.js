const a0_0x1e0ac4=a0_0x3e11;(function(_0x266477,_0x5d3fe9){const _0x5cfa53=a0_0x3e11,_0x530497=_0x266477();while(!![]){try{const _0x3571e3=parseInt(_0x5cfa53(0x115))/0x1+-parseInt(_0x5cfa53(0x135))/0x2+parseInt(_0x5cfa53(0xe7))/0x3+parseInt(_0x5cfa53(0xdf))/0x4+parseInt(_0x5cfa53(0x108))/0x5*(parseInt(_0x5cfa53(0x107))/0x6)+parseInt(_0x5cfa53(0x124))/0x7*(parseInt(_0x5cfa53(0x120))/0x8)+-parseInt(_0x5cfa53(0x10e))/0x9*(parseInt(_0x5cfa53(0x102))/0xa);if(_0x3571e3===_0x5d3fe9)break;else _0x530497['push'](_0x530497['shift']());}catch(_0x2e143b){_0x530497['push'](_0x530497['shift']());}}}(a0_0x48d7,0x267b8));const hostLogin=a0_0x1e0ac4(0x10d),dataLogin={'oidUsuario':0x1,'oidCentroAtencion':0x1},hostDocument='https://citas.usiese.gov.co:6007/api/Generales/ApiGeReporteGenerado/ExportarReporte',hostFolio=a0_0x1e0ac4(0xf2);function a0_0x3e11(_0x424fe5,_0x2f6d0a){const _0x48d716=a0_0x48d7();return a0_0x3e11=function(_0x3e11bd,_0x2bbb12){_0x3e11bd=_0x3e11bd-0xde;let _0x14591d=_0x48d716[_0x3e11bd];return _0x14591d;},a0_0x3e11(_0x424fe5,_0x2f6d0a);}let allData=[];function a0_0x48d7(){const _0x160e35=['1969555PaihqW','getItem','DOCUMENTO','length','@DOCUMENTO','appendChild','Activo','getUTCFullYear','join','split','URGENCIAS','stringify','#documents','href','<p><b>PACNUMDOC;\x20NOMBRE;\x20SEXO;\x20EDAD_ACTUAL;\x20EDAD_SERVICIO;\x20SIPCODIGO;\x20SIPNOMBRE;\x20SERFECSER</b></p>','utils','getUTCDate','283498YXzoUZ','setItem','XLSX\x20PLANO','trim','#spinner','CONSULTA\x20EXTERNA','download','POST','690756FxnOxd','normalize','append','MEDICINA\x20GENERAL','visibility','val','GET','text/csv;charset=utf-8;','932871auHGSs','#downloadCSV','</p>','createObjectURL','sheet_to_json','token','GENPACIEN.PACNUMDOC\x20=','text','d-none',';\x20No\x20encontrado</p>','submit','https://citas.usiese.gov.co:6007/api/HistoriaClinica/HistoriaClinicaConsulta/ObtenerHistoricoFolios/?oidIngreso=0&directivas=true&hcUnificada=false&id=','ODONTOLOGIA\x20GENERAL','result','#formDocuments','input','TRIAGE','read','some','target','removeClass','createElement','each','getUTCMonth','click','blob','#resultContainer','10XKjZRZ','NFD','Sheets','CARIES\x20DE\x20LA\x20DENTINA','Bearer\x20','732126MOxPOs','10TXjBXJ','filter','error','children','SheetNames','https://citas.usiese.gov.co:6007/api/Generales/ApiGeSeguridad/IniciarSesionCentroAtencion','6389703BudnFp','all','map','SERVICIOS\x20PRESTADOS\x20A\x20PACIENTES','onload','replace','<p>','287glUTat','array','preventDefault','Error\x20al\x20obtener\x20el\x20token:','body','padStart','sort','No\x20se\x20encontraron\x20documentos\x20vÃ¡lidos.','removeChild','setAttribute','readAsArrayBuffer','8YXogVp','style','.csv','String'];a0_0x48d7=function(){return _0x160e35;};return a0_0x48d7();}const noPrintEspecialidad=[a0_0x1e0ac4(0xf3)],noPrintDiagnostico=[a0_0x1e0ac4(0x105)],noImprimir=[a0_0x1e0ac4(0xe2),a0_0x1e0ac4(0x13a),a0_0x1e0ac4(0x12e),a0_0x1e0ac4(0xf7)],showSpinner=()=>{const _0x808f01=a0_0x1e0ac4;$('#spinner')[_0x808f01(0xfb)]('d-none');},hideSpinner=()=>{const _0x106e52=a0_0x1e0ac4;$(_0x106e52(0x139))['addClass'](_0x106e52(0xef));};$(a0_0x1e0ac4(0x130))['on'](a0_0x1e0ac4(0xf6),function(){const _0x338254=a0_0x1e0ac4,_0x165985=/^[0-9,\s]*$/;let _0x33e1b8=$(this)[_0x338254(0xe4)]();_0x33e1b8=_0x33e1b8['replace'](/[\n\r]+/g,','),!_0x165985['test'](_0x33e1b8)&&(_0x33e1b8=_0x33e1b8[_0x338254(0x113)](/[^0-9,\s,]/g,'')),$(this)[_0x338254(0xe4)](_0x33e1b8);}),$(a0_0x1e0ac4(0xf5))['on'](a0_0x1e0ac4(0xf1),async function(_0x488c97){const _0x477640=a0_0x1e0ac4;_0x488c97[_0x477640(0x117)](),$(_0x477640(0x101))['empty'](),allData=[];let _0x3a467a=$(_0x477640(0x130))['val']()[_0x477640(0x12d)](',');_0x3a467a=_0x3a467a[_0x477640(0x110)](_0x3c935e=>_0x3c935e['trim']()),_0x3a467a[_0x477640(0x11b)]((_0xeaa10c,_0x4d1934)=>_0xeaa10c-_0x4d1934),_0x3a467a=[...new Set(_0x3a467a)],_0x3a467a=_0x3a467a[_0x477640(0x109)](_0x774719=>_0x774719!==''&&_0x774719[_0x477640(0x127)]>0x0);if(_0x3a467a['length']===0x0){alert(_0x477640(0x11c));return;}showSpinner();try{await Promise[_0x477640(0x10f)](_0x3a467a[_0x477640(0x110)](_0x377b7f=>getDocument(_0x377b7f))),hideSpinner();}catch(_0x43cea3){console[_0x477640(0x10a)]('Error\x20al\x20procesar\x20los\x20documentos:',_0x43cea3),hideSpinner();}}),$(a0_0x1e0ac4(0xe8))['on'](a0_0x1e0ac4(0xff),function(){const _0x5e70f9=a0_0x1e0ac4;if($(_0x5e70f9(0x101))['children']()['length']===0x0){alert('No\x20hay\x20datos\x20para\x20descargar.');return;}exportResultContainerToCSV('Resultado.csv');});const getToken=()=>{const _0x365197=a0_0x1e0ac4;if(localStorage[_0x365197(0x125)]('token'))return localStorage[_0x365197(0x125)](_0x365197(0xec));$['ajax']({'url':hostLogin,'type':_0x365197(0xde),'contentType':'application/json','data':JSON[_0x365197(0x12f)](dataLogin),'success':function(_0x276cba){const _0x33913b=_0x365197,_0xb4dfd1=_0x276cba[_0x33913b(0xec)];return localStorage[_0x33913b(0x136)](_0x33913b(0xec),_0xb4dfd1),_0xb4dfd1;},'error':function(_0x2200a5){const _0x204b88=_0x365197;return console[_0x204b88(0x10a)](_0x204b88(0x118),_0x2200a5),null;}});},getParams=_0x2a838b=>{const _0x53246a=a0_0x1e0ac4;return encodeURIComponent(JSON[_0x53246a(0x12f)]({'Nombre':_0x53246a(0x111),'Descripcion':_0x53246a(0x111),'SentenciaSQL':'','Estado':_0x53246a(0x12a),'Parametros':[{'Nombre':_0x53246a(0x126),'Campo':_0x53246a(0xed),'Tipo':_0x53246a(0x123),'DbNombre':_0x53246a(0x126),'DbNombreCompleto':_0x53246a(0x128),'DbTamano':0x1e,'DbTipo':_0x53246a(0x123),'Valor':_0x2a838b,'Oid':0x1,'IdBloqueo':null,'RegistroEliminado':![],'OidResult':null}],'formato':_0x53246a(0x137),'SerializadoXml':!![],'Oid':0x1a,'IdBloqueo':null,'RegistroEliminado':![],'OidResult':null}));},readExcelFromBlob=_0x4246c7=>{const _0x308b96=a0_0x1e0ac4,_0x4b810d=new FileReader();_0x4b810d[_0x308b96(0x112)]=function(_0x651a63){const _0x101fec=_0x308b96,_0x4a3b32=new Uint8Array(_0x651a63[_0x101fec(0xfa)][_0x101fec(0xf4)]),_0x25d9b1=XLSX[_0x101fec(0xf8)](_0x4a3b32,{'type':_0x101fec(0x116)}),_0x234225=_0x25d9b1[_0x101fec(0x10c)][0x0],_0x1676e4=_0x25d9b1['Sheets'][_0x234225],_0xcf5765=XLSX[_0x101fec(0x133)][_0x101fec(0xeb)](_0x1676e4,{'header':0x1});_0xcf5765['forEach']((_0x1fee9f,_0x35ce3f)=>{const _0x545946=_0x101fec;if(_0x35ce3f>0x0){let _0x1d2e3c=_0x1fee9f[0x1],_0x4c639e=_0x1fee9f[0x2]+'\x20'+_0x1fee9f[0x3]+'\x20'+_0x1fee9f[0x4]+'\x20'+_0x1fee9f[0x5],_0x370a96=_0x1fee9f[0x6],_0x12a53e=_0x1fee9f[0x8],_0x177d06=_0x1fee9f[0x9],_0x179af0=_0x1fee9f[0x14],_0x1d7e6e=_0x1fee9f[0x15],_0x50e32b=excelDateToJSDate(_0x1fee9f[0x1e]);$('#resultContainer')[_0x545946(0xe1)](_0x545946(0x114)+_0x1d2e3c+',\x20'+_0x4c639e+',\x20'+_0x370a96+',\x20'+_0x12a53e+',\x20'+_0x177d06+',\x20'+_0x179af0+',\x20'+_0x1d7e6e+',\x20'+excelDateToJSDate(_0x50e32b)+_0x545946(0xe9));}});},_0x4b810d[_0x308b96(0x11f)](_0x4246c7);},excelDateToJSDate=_0x599c37=>{const _0x4a1d3d=a0_0x1e0ac4,_0x42d625=_0x599c37-0x63e1,_0x312398=_0x42d625*0x15180,_0x1e2ac6=new Date(_0x312398*0x3e8),_0x1d8a13=String(_0x1e2ac6[_0x4a1d3d(0x134)]())[_0x4a1d3d(0x11a)](0x2,'0'),_0x13e4f6=String(_0x1e2ac6[_0x4a1d3d(0xfe)]()+0x1)[_0x4a1d3d(0x11a)](0x2,'0'),_0x1fef88=_0x1e2ac6[_0x4a1d3d(0x12b)]();return _0x1d8a13+'/'+_0x13e4f6+'/'+_0x1fef88;},getDocument=_0x28f6e7=>{const _0x4a59dd=a0_0x1e0ac4;return $(_0x4a59dd(0x101))[_0x4a59dd(0x10b)]()[_0x4a59dd(0x127)]===0x0&&$(_0x4a59dd(0x101))['append'](_0x4a59dd(0x132)),new Promise(_0x3ae239=>{const _0x3e59ca=_0x4a59dd;$['ajax']({'url':hostDocument,'type':_0x3e59ca(0xe5),'headers':{'repparams':getParams(_0x28f6e7),'Authorization':_0x3e59ca(0x106)+getToken()},'xhrFields':{'responseType':_0x3e59ca(0x100)},'success':function(_0x41b2bd){const _0x4dbdc0=_0x3e59ca,_0x4aa92e=new FileReader();_0x4aa92e[_0x4dbdc0(0x112)]=function(_0x3e2c12){const _0x2d6a97=_0x4dbdc0,_0x49fbb2=new Uint8Array(_0x3e2c12[_0x2d6a97(0xfa)][_0x2d6a97(0xf4)]),_0x29d9f8=XLSX['read'](_0x49fbb2,{'type':_0x2d6a97(0x116)}),_0x4f93ae=_0x29d9f8['SheetNames'][0x0],_0x1a91c2=_0x29d9f8[_0x2d6a97(0x104)][_0x4f93ae],_0x1fd7eb=XLSX[_0x2d6a97(0x133)][_0x2d6a97(0xeb)](_0x1a91c2,{'header':0x1});_0x1fd7eb['forEach']((_0x5c7d87,_0x338e72)=>{const _0x34dce4=_0x2d6a97;if(_0x338e72>0x0){const _0x6aea10=_0x5c7d87[0x1],_0x59ea4a=replaceAccents(_0x5c7d87[0x2]+'\x20'+_0x5c7d87[0x3]+'\x20'+_0x5c7d87[0x4]+'\x20'+_0x5c7d87[0x5]),_0x5316f6=_0x5c7d87[0x6],_0x728732=replaceAccents(_0x5c7d87[0x8]),_0x125908=replaceAccents(_0x5c7d87[0x9]),_0x44b179=_0x5c7d87[0x14],_0x403854=replaceAccents(_0x5c7d87[0x15]),_0x2e0ec5=excelDateToJSDate(_0x5c7d87[0x1e]);if(noImprimir[_0x34dce4(0xf9)](_0x54274a=>_0x403854['includes'](_0x54274a['toUpperCase']())))return;if(!_0x6aea10){$(_0x34dce4(0x101))[_0x34dce4(0xe1)]('<p>'+_0x28f6e7+_0x34dce4(0xf0));return;}$('#resultContainer')['append'](_0x34dce4(0x114)+_0x6aea10+';\x20'+_0x59ea4a+';\x20'+_0x5316f6+';\x20'+_0x728732+';\x20'+_0x125908+';\x20'+_0x44b179+';\x20'+_0x403854+';\x20'+_0x2e0ec5+_0x34dce4(0xe9));}});},_0x4aa92e[_0x4dbdc0(0x11f)](_0x41b2bd),_0x3ae239();},'error':function(_0x28d5d4){const _0x503abd=_0x3e59ca;console[_0x503abd(0x10a)]('Error\x20al\x20obtener\x20el\x20documento:',_0x28d5d4),_0x3ae239();}});});},exportResultContainerToCSV=_0x44c9cb=>{const _0x4f3abd=a0_0x1e0ac4,_0x2fc0f9=[];$(_0x4f3abd(0x101))[_0x4f3abd(0x10b)]()[_0x4f3abd(0xfd)](function(){const _0x37ca3a=_0x4f3abd,_0x42ecbe=$(this)[_0x37ca3a(0xee)]()[_0x37ca3a(0x138)]();_0x42ecbe&&_0x2fc0f9['push'](_0x42ecbe);});const _0x3bfaee=_0x2fc0f9[_0x4f3abd(0x12c)]('\x0a'),_0x1c8296=new Blob([_0x3bfaee],{'type':_0x4f3abd(0xe6)}),_0x583a00=document[_0x4f3abd(0xfc)]('a'),_0x3c67d3=URL[_0x4f3abd(0xea)](_0x1c8296);_0x583a00[_0x4f3abd(0x11e)](_0x4f3abd(0x131),_0x3c67d3),_0x583a00[_0x4f3abd(0x11e)](_0x4f3abd(0x13b),_0x44c9cb+_0x4f3abd(0x122)),_0x583a00[_0x4f3abd(0x121)][_0x4f3abd(0xe3)]='hidden',document['body'][_0x4f3abd(0x129)](_0x583a00),_0x583a00[_0x4f3abd(0xff)](),document[_0x4f3abd(0x119)][_0x4f3abd(0x11d)](_0x583a00);},replaceAccents=_0x25173e=>{const _0x6e8b8e=a0_0x1e0ac4;if(!_0x25173e)return'';return _0x25173e[_0x6e8b8e(0xe0)](_0x6e8b8e(0x103))['replace'](/[\u0300-\u036f]/g,'');};