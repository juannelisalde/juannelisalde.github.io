const a0_0x2ddd80=a0_0x3421;(function(_0x2cf320,_0x437204){const _0x5b160b=a0_0x3421,_0x139fb0=_0x2cf320();while(!![]){try{const _0x2a8107=parseInt(_0x5b160b(0x1d2))/0x1*(-parseInt(_0x5b160b(0x1a4))/0x2)+-parseInt(_0x5b160b(0x1f1))/0x3*(parseInt(_0x5b160b(0x1eb))/0x4)+parseInt(_0x5b160b(0x1e4))/0x5*(parseInt(_0x5b160b(0x1e5))/0x6)+parseInt(_0x5b160b(0x1ed))/0x7*(parseInt(_0x5b160b(0x1c0))/0x8)+-parseInt(_0x5b160b(0x1cc))/0x9+-parseInt(_0x5b160b(0x1b5))/0xa+parseInt(_0x5b160b(0x1a5))/0xb*(parseInt(_0x5b160b(0x1b8))/0xc);if(_0x2a8107===_0x437204)break;else _0x139fb0['push'](_0x139fb0['shift']());}catch(_0x53305d){_0x139fb0['push'](_0x139fb0['shift']());}}}(a0_0x5eb1,0xa8830));const hostLogin='https://citas.usiese.gov.co:6007/api/Generales/ApiGeSeguridad/IniciarSesionCentroAtencion',dataLogin={'oidUsuario':0x1,'oidCentroAtencion':0x1},hostDocument='https://citas.usiese.gov.co:6007/api/Generales/ApiGeReporteGenerado/ExportarReporte',hostFolio='https://citas.usiese.gov.co:6007/api/HistoriaClinica/HistoriaClinicaConsulta/ObtenerHistoricoFolios/?oidIngreso=0&directivas=true&hcUnificada=false&id=';let allData=[];const noPrintEspecialidad=[a0_0x2ddd80(0x1d0)],noPrintDiagnostico=['CARIES\x20DE\x20LA\x20DENTINA'],noImprimir=[a0_0x2ddd80(0x1de),a0_0x2ddd80(0x1f9),a0_0x2ddd80(0x1bd)],showSpinner=()=>{const _0x437beb=a0_0x2ddd80;$(_0x437beb(0x1ba))[_0x437beb(0x1a3)](_0x437beb(0x1c5));},hideSpinner=()=>{const _0x4fcab2=a0_0x2ddd80;$(_0x4fcab2(0x1ba))[_0x4fcab2(0x1e7)](_0x4fcab2(0x1c5));};$(a0_0x2ddd80(0x1cd))['on'](a0_0x2ddd80(0x1e3),function(){const _0x326201=a0_0x2ddd80;$(this)['parent']()['find'](_0x326201(0x1bf))[_0x326201(0x1a0)](''),$(this)[_0x326201(0x1ff)]()[_0x326201(0x1d8)](_0x326201(0x1f5))[_0x326201(0x1a0)](''),$(_0x326201(0x1a8))[_0x326201(0x1e7)](_0x326201(0x1c5));}),$(a0_0x2ddd80(0x1b7))['on'](a0_0x2ddd80(0x1bf),function(){const _0x4b1f68=a0_0x2ddd80,_0x1a932b=/^[0-9,\s]*$/;let _0x210f2a=$(this)[_0x4b1f68(0x1a0)]();_0x210f2a=_0x210f2a[_0x4b1f68(0x1c2)](/[\n\r]+/g,','),!_0x1a932b[_0x4b1f68(0x1fe)](_0x210f2a)&&(_0x210f2a=_0x210f2a[_0x4b1f68(0x1c2)](/[^0-9,\s,]/g,'')),$(this)[_0x4b1f68(0x1a0)](_0x210f2a);}),$(a0_0x2ddd80(0x1d9))['on'](a0_0x2ddd80(0x1d1),async function(_0x362574){const _0x22df1e=a0_0x2ddd80;_0x362574['preventDefault'](),$(_0x22df1e(0x1fa))[_0x22df1e(0x199)](),allData=[];let _0x21764c=$('#documents')[_0x22df1e(0x1a0)]()[_0x22df1e(0x1c6)](',');_0x21764c=_0x21764c[_0x22df1e(0x1e9)](_0x237fed=>_0x237fed[_0x22df1e(0x1d6)]()),_0x21764c['sort']((_0x4bc3b2,_0x11c94c)=>_0x4bc3b2-_0x11c94c),_0x21764c=[...new Set(_0x21764c)],_0x21764c=_0x21764c[_0x22df1e(0x1c9)](_0xde51a=>_0xde51a!==''&&_0xde51a[_0x22df1e(0x1f4)]>0x0);if(_0x21764c[_0x22df1e(0x1f4)]===0x0){alert('No\x20se\x20encontraron\x20documentos\x20válidos.');return;}showSpinner();try{await Promise[_0x22df1e(0x1a7)](_0x21764c[_0x22df1e(0x1e9)](_0x2c2e92=>getDocument(_0x2c2e92))),$(_0x22df1e(0x1ef))['removeClass'](_0x22df1e(0x1c5)),hideSpinner();}catch(_0x2e8c29){console[_0x22df1e(0x19b)](_0x22df1e(0x1f7),_0x2e8c29),hideSpinner();}}),$(a0_0x2ddd80(0x205))['on'](a0_0x2ddd80(0x1e3),function(){const _0x5d0911=a0_0x2ddd80;if($(_0x5d0911(0x1fa))['children']()[_0x5d0911(0x1f4)]===0x0){alert('No\x20hay\x20datos\x20para\x20descargar.');return;}exportResultContainerToCSV(_0x5d0911(0x1ac));});function a0_0x3421(_0x2902f7,_0x571ab8){const _0x5eb19f=a0_0x5eb1();return a0_0x3421=function(_0x342163,_0x4371c0){_0x342163=_0x342163-0x197;let _0x480632=_0x5eb19f[_0x342163];return _0x480632;},a0_0x3421(_0x2902f7,_0x571ab8);}const getToken=()=>{const _0x1cc4d=a0_0x2ddd80;if(localStorage[_0x1cc4d(0x1d7)](_0x1cc4d(0x1cb)))return localStorage[_0x1cc4d(0x1d7)](_0x1cc4d(0x1cb));$[_0x1cc4d(0x1c3)]({'url':hostLogin,'type':_0x1cc4d(0x1b3),'contentType':_0x1cc4d(0x1b1),'data':JSON[_0x1cc4d(0x1ad)](dataLogin),'success':function(_0x1f8973){const _0x5e558c=_0x1cc4d,_0x2f0f4e=_0x1f8973[_0x5e558c(0x1cb)];return localStorage[_0x5e558c(0x1c8)](_0x5e558c(0x1cb),_0x2f0f4e),_0x2f0f4e;},'error':function(_0x20cc78){const _0x28510c=_0x1cc4d;return console[_0x28510c(0x19b)]('Error\x20al\x20obtener\x20el\x20token:',_0x20cc78),null;}});},getParams=_0x3b95dd=>{const _0x8415a9=a0_0x2ddd80;return encodeURIComponent(JSON[_0x8415a9(0x1ad)]({'Nombre':'SERVICIOS\x20PRESTADOS\x20A\x20PACIENTES','Descripcion':_0x8415a9(0x1d5),'SentenciaSQL':'','Estado':_0x8415a9(0x1c4),'Parametros':[{'Nombre':_0x8415a9(0x19d),'Campo':_0x8415a9(0x197),'Tipo':'String','DbNombre':_0x8415a9(0x19d),'DbNombreCompleto':'@DOCUMENTO','DbTamano':0x1e,'DbTipo':_0x8415a9(0x1bb),'Valor':_0x3b95dd,'Oid':0x1,'IdBloqueo':null,'RegistroEliminado':![],'OidResult':null}],'formato':'XLSX\x20PLANO','SerializadoXml':!![],'Oid':0x1a,'IdBloqueo':null,'RegistroEliminado':![],'OidResult':null}));},readExcelFromBlob=_0xe7559c=>{const _0x3aec49=a0_0x2ddd80,_0x433964=new FileReader();_0x433964['onload']=function(_0x549d8e){const _0x24d126=a0_0x3421,_0x35a878=new Uint8Array(_0x549d8e[_0x24d126(0x1e8)]['result']),_0x57a011=XLSX['read'](_0x35a878,{'type':_0x24d126(0x1b0)}),_0x82917d=_0x57a011[_0x24d126(0x19e)][0x0],_0x24c196=_0x57a011[_0x24d126(0x204)][_0x82917d],_0x5c3b3d=XLSX[_0x24d126(0x19c)][_0x24d126(0x1e6)](_0x24c196,{'header':0x1});_0x5c3b3d[_0x24d126(0x1aa)]((_0x4f30f9,_0xad1bd5)=>{const _0x54b922=_0x24d126;if(_0xad1bd5>0x0){let _0x2bfdc9=_0x4f30f9[0x1],_0x3904c7=_0x4f30f9[0x2]+'\x20'+_0x4f30f9[0x3]+'\x20'+_0x4f30f9[0x4]+'\x20'+_0x4f30f9[0x5],_0x3fa411=_0x4f30f9[0x6],_0x61e4c6=_0x4f30f9[0x8],_0xa8a12f=_0x4f30f9[0x9],_0x8f6211=_0x4f30f9[0x14],_0x5a1b8c=_0x4f30f9[0x15],_0x4c6954=excelDateToJSDate(_0x4f30f9[0x1e]);$(_0x54b922(0x1fa))[_0x54b922(0x1c1)](_0x54b922(0x202)+_0x2bfdc9+',\x20'+_0x3904c7+',\x20'+_0x3fa411+',\x20'+_0x61e4c6+',\x20'+_0xa8a12f+',\x20'+_0x8f6211+',\x20'+_0x5a1b8c+',\x20'+excelDateToJSDate(_0x4c6954)+_0x54b922(0x198));}});},_0x433964[_0x3aec49(0x1b2)](_0xe7559c);},excelDateToJSDate=_0x4f7f08=>{const _0x1a64a9=a0_0x2ddd80,_0x31f63e=_0x4f7f08-0x63e1,_0x1cad2d=_0x31f63e*0x15180,_0x595e66=new Date(_0x1cad2d*0x3e8),_0x3ad265=String(_0x595e66[_0x1a64a9(0x1af)]())['padStart'](0x2,'0'),_0x28c01b=String(_0x595e66[_0x1a64a9(0x1d4)]()+0x1)['padStart'](0x2,'0'),_0x5291c3=_0x595e66['getUTCFullYear']();return _0x3ad265+'/'+_0x28c01b+'/'+_0x5291c3;},getDocument=_0x1ad705=>{const _0x98e7d7=a0_0x2ddd80;return $(_0x98e7d7(0x1fa))[_0x98e7d7(0x1c7)]()['length']===0x0&&$('#resultContainerDownloadDates')['append'](_0x98e7d7(0x1fc)),new Promise(_0x21f728=>{const _0x11ff0b=_0x98e7d7;$[_0x11ff0b(0x1c3)]({'url':hostDocument,'type':_0x11ff0b(0x1ec),'headers':{'repparams':getParams(_0x1ad705),'Authorization':_0x11ff0b(0x1ae)+getToken()},'xhrFields':{'responseType':_0x11ff0b(0x19f)},'success':function(_0x5cd08b){const _0x24199d=_0x11ff0b,_0x268045=new FileReader();_0x268045[_0x24199d(0x1e0)]=function(_0x36183c){const _0x28d198=_0x24199d,_0x517a65=new Uint8Array(_0x36183c['target'][_0x28d198(0x1f2)]),_0x2a0478=XLSX[_0x28d198(0x201)](_0x517a65,{'type':_0x28d198(0x1b0)}),_0x427b2d=_0x2a0478['SheetNames'][0x0],_0x6276c7=_0x2a0478[_0x28d198(0x204)][_0x427b2d],_0x36bc68=XLSX[_0x28d198(0x19c)][_0x28d198(0x1e6)](_0x6276c7,{'header':0x1});let _0x493453=![],_0x4846e0=[];_0x36bc68[_0x28d198(0x1aa)]((_0x46a01d,_0x2c0e71)=>{const _0x5b7b78=_0x28d198;if(_0x2c0e71>0x0){const _0x37c24c=_0x46a01d[0x1],_0x1fcef8=replaceAccents(_0x46a01d[0x2]+'\x20'+_0x46a01d[0x3]+'\x20'+_0x46a01d[0x4]+'\x20'+_0x46a01d[0x5]),_0xd2059d=_0x46a01d[0x6],_0xe44da=replaceAccents(_0x46a01d[0x8]),_0x4f6f24=replaceAccents(_0x46a01d[0x9]),_0x98b3dd=_0x46a01d[0x14],_0x28c58d=replaceAccents(_0x46a01d[0x15]),_0x266b74=excelDateToJSDate(_0x46a01d[0x1e]);if(noImprimir['some'](_0xad9df=>_0x28c58d[_0x5b7b78(0x1ab)](_0xad9df[_0x5b7b78(0x1b4)]())))return;if(!_0x37c24c){$('#resultContainerDownloadDates')[_0x5b7b78(0x1c1)](_0x5b7b78(0x202)+_0x1ad705+_0x5b7b78(0x19a)),_0x493453=!![];return;}!_0x4846e0[_0x5b7b78(0x1ab)](_0x98b3dd)&&$(_0x5b7b78(0x1fa))[_0x5b7b78(0x1c1)]('<p>'+_0x37c24c+';\x20'+_0x1fcef8+';\x20'+_0xd2059d+';\x20'+_0xe44da+';\x20'+_0x4f6f24+';\x20'+_0x98b3dd+';\x20'+_0x28c58d+';\x20'+_0x266b74+_0x5b7b78(0x198)),_0x4846e0[_0x5b7b78(0x1df)](_0x98b3dd),_0x493453=!![];}}),!_0x493453&&$(_0x28d198(0x1fa))[_0x28d198(0x1c1)](_0x28d198(0x202)+_0x1ad705+_0x28d198(0x1f8));},_0x268045[_0x24199d(0x1b2)](_0x5cd08b),_0x21f728();},'error':function(_0x1bd278){const _0x504c1d=_0x11ff0b;console['error'](_0x504c1d(0x1f0),_0x1bd278),_0x21f728();}});});},exportResultContainerToCSV=_0x3548bd=>{const _0x24fb03=a0_0x2ddd80,_0x2b4f8d=[];$('#resultContainerDownloadDates')['children']()['each'](function(){const _0x5d52d7=a0_0x3421,_0x4e53c9=$(this)[_0x5d52d7(0x1cf)]()[_0x5d52d7(0x1d6)]();_0x4e53c9&&_0x2b4f8d[_0x5d52d7(0x1df)](_0x4e53c9);});const _0x1eb250=_0x2b4f8d['join']('\x0a'),_0x487ac3=new Blob([_0x1eb250],{'type':_0x24fb03(0x1bc)}),_0x30a048=document[_0x24fb03(0x1a1)]('a'),_0x2f90f3=URL['createObjectURL'](_0x487ac3);_0x30a048[_0x24fb03(0x1b9)]('href',_0x2f90f3),_0x30a048[_0x24fb03(0x1b9)](_0x24fb03(0x1a9),_0x3548bd+'.csv'),_0x30a048[_0x24fb03(0x1ee)][_0x24fb03(0x1dc)]=_0x24fb03(0x1dd),document['body']['appendChild'](_0x30a048),_0x30a048[_0x24fb03(0x1e3)](),document[_0x24fb03(0x1fb)][_0x24fb03(0x1d3)](_0x30a048);},replaceAccents=_0x150efc=>{const _0xc3dd=a0_0x2ddd80;if(!_0x150efc)return'';return _0x150efc['normalize'](_0xc3dd(0x1b6))[_0xc3dd(0x1c2)](/[\u0300-\u036f]/g,'');},processDates=_0x57fd79=>{const _0x44ae09=a0_0x2ddd80;return _0x57fd79[_0x44ae09(0x1e9)](_0x13e232=>{const _0x135287=_0x44ae09,_0x25c0ef=_0x13e232[_0x135287(0x1c6)]('/');if(_0x25c0ef[_0x135287(0x1f4)]!==0x3)return _0x135287(0x1fd);let [_0x3464cb,_0x59e968,_0x25cfa3]=_0x25c0ef[_0x135287(0x1e9)](_0x2cc665=>parseInt(_0x2cc665,0xa));if(_0x59e968>0xc)return _0x59e968+'/'+_0x3464cb+'/'+_0x25cfa3;return _0x3464cb+'/'+_0x59e968+'/'+_0x25cfa3;});};function a0_0x5eb1(){const _0x38b3b3=['removeClass','142xjNjkz','23705lzBneJ','#dates','all','.results','download','forEach','includes','Resultado.csv','stringify','Bearer\x20','getUTCDate','array','application/json','readAsArrayBuffer','POST','toUpperCase','9222420lZgizE','NFD','#documents','12372HjmyoG','setAttribute','#spinner','String','text/csv;charset=utf-8;','TRIAGE','clipboard','input','93616trfipN','append','replace','ajax','Activo','d-none','split','children','setItem','filter','#resultContainerFormatDatesCard','token','3756330cTXhYZ','.clean','preventDefault','text','ODONTOLOGIA\x20GENERAL','submit','1201Lbzjih','removeChild','getUTCMonth','SERVICIOS\x20PRESTADOS\x20A\x20PACIENTES','trim','getItem','find','#formDownloadDates','html','#resultContainerFormatDates','visibility','hidden','CONSULTA\x20EXTERNA','push','onload','No\x20hay\x20fechas\x20formateadas\x20para\x20copiar','<br>','click','3388130SyhlLa','6jJvORB','sheet_to_json','addClass','target','map','writeText','2621828rmkOZW','GET','315dIHWqm','style','#resultContainerDownloadDatesCard','Error\x20al\x20obtener\x20el\x20documento:','6nBbPSR','result','join','length','textarea','</br>','Error\x20al\x20procesar\x20los\x20documentos:',';\x20sin\x20PM</p>','URGENCIAS','#resultContainerDownloadDates','body','<p><b>PACNUMDOC;\x20NOMBRE;\x20SEXO;\x20EDAD_ACTUAL;\x20EDAD_SERVICIO;\x20SIPCODIGO;\x20SIPNOMBRE;\x20SERFECSER</b></p>','Fecha\x20inválida','test','parent','No\x20se\x20pudieron\x20copiar\x20las\x20fechas','read','<p>','then','Sheets','#downloadCSV','GENPACIEN.PACNUMDOC\x20=','</p>','empty',';\x20sin\x20citas</p>','error','utils','DOCUMENTO','SheetNames','blob','val','createElement','#formFormatDates'];a0_0x5eb1=function(){return _0x38b3b3;};return a0_0x5eb1();}$(a0_0x2ddd80(0x1a2))['on'](a0_0x2ddd80(0x1d1),async function(_0x1de1b3){const _0x376f9a=a0_0x2ddd80;_0x1de1b3[_0x376f9a(0x1ce)](),showSpinner(),$(_0x376f9a(0x1db))[_0x376f9a(0x199)]();let _0x5b7d97=$(_0x376f9a(0x1a6))[_0x376f9a(0x1a0)]()[_0x376f9a(0x1c2)](/[\n\r]+/g,',')[_0x376f9a(0x1c6)](',');_0x5b7d97=_0x5b7d97['map'](_0x41d24c=>_0x41d24c[_0x376f9a(0x1d6)]()),_0x5b7d97=_0x5b7d97[_0x376f9a(0x1c9)](_0x1f1db1=>_0x1f1db1!=='');const _0x43f3d8=processDates(_0x5b7d97);_0x43f3d8[_0x376f9a(0x1aa)](_0x1c53e9=>{const _0x1e7ad9=_0x376f9a;$(_0x1e7ad9(0x1db))[_0x1e7ad9(0x1c1)](_0x1c53e9+_0x1e7ad9(0x1f6));}),$(_0x376f9a(0x1ca))[_0x376f9a(0x1a3)]('d-none'),hideSpinner();}),$('#copyFormattedDates')['on'](a0_0x2ddd80(0x1e3),function(){const _0x179259=a0_0x2ddd80,_0x2d020e=$('#resultContainerFormatDates')[_0x179259(0x1da)]()[_0x179259(0x1d6)]();if(_0x2d020e){const _0x3e51ee=_0x2d020e['split'](_0x179259(0x1e2))[_0x179259(0x1e9)](_0x35a018=>_0x35a018[_0x179259(0x1d6)]())[_0x179259(0x1c9)](_0x24dbf9=>_0x24dbf9!=='')[_0x179259(0x1f3)]('\x0a');navigator[_0x179259(0x1be)][_0x179259(0x1ea)](_0x3e51ee)[_0x179259(0x203)](()=>{alert('Fechas\x20copiadas\x20al\x20portapapeles');})['catch'](_0x53a28f=>{const _0x32849b=_0x179259;console[_0x32849b(0x19b)]('Error\x20al\x20copiar\x20las\x20fechas:\x20',_0x53a28f),alert(_0x32849b(0x200));});}else alert(_0x179259(0x1e1));});