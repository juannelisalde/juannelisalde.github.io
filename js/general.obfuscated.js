const a0_0x2e4af2=a0_0x2d75;(function(_0x506a8a,_0xda6159){const _0x72f29a=a0_0x2d75,_0xebd734=_0x506a8a();while(!![]){try{const _0x78acb2=-parseInt(_0x72f29a(0xe8))/0x1+-parseInt(_0x72f29a(0xce))/0x2*(-parseInt(_0x72f29a(0xe7))/0x3)+parseInt(_0x72f29a(0xcd))/0x4*(-parseInt(_0x72f29a(0xee))/0x5)+-parseInt(_0x72f29a(0x103))/0x6+-parseInt(_0x72f29a(0xc7))/0x7*(parseInt(_0x72f29a(0xc2))/0x8)+-parseInt(_0x72f29a(0x11f))/0x9+parseInt(_0x72f29a(0xec))/0xa;if(_0x78acb2===_0xda6159)break;else _0xebd734['push'](_0xebd734['shift']());}catch(_0x497f24){_0xebd734['push'](_0xebd734['shift']());}}}(a0_0x3678,0xc753a));const hostLogin=a0_0x2e4af2(0xd6),dataLogin={'oidUsuario':0x1,'oidCentroAtencion':0x1},hostDocument='https://citas.usiese.gov.co:6007/api/Generales/ApiGeReporteGenerado/ExportarReporte',hostFolio=a0_0x2e4af2(0x104);let allData=[];const noPrintEspecialidad=[a0_0x2e4af2(0xe5)],noPrintDiagnostico=['CARIES\x20DE\x20LA\x20DENTINA'],noImprimir=[a0_0x2e4af2(0xeb),a0_0x2e4af2(0xe4),a0_0x2e4af2(0x11a)],showSpinner=()=>{const _0x30fb31=a0_0x2e4af2;$(_0x30fb31(0x111))[_0x30fb31(0xd5)](_0x30fb31(0x117));},hideSpinner=()=>{const _0x5d56c5=a0_0x2e4af2;$(_0x5d56c5(0x111))[_0x5d56c5(0xe1)](_0x5d56c5(0x117));};$(a0_0x2e4af2(0x10a))['on'](a0_0x2e4af2(0xed),function(){const _0x39358c=a0_0x2e4af2;$(this)[_0x39358c(0x122)]()['find'](_0x39358c(0xd2))[_0x39358c(0x126)](''),$(this)[_0x39358c(0x122)]()[_0x39358c(0x113)]('textarea')[_0x39358c(0x126)](''),$(_0x39358c(0xda))['addClass'](_0x39358c(0x117));}),$(a0_0x2e4af2(0xc8))['on'](a0_0x2e4af2(0xd2),function(){const _0xc23c63=a0_0x2e4af2,_0x3f8e77=/^[0-9,\s]*$/;let _0xe84b4b=$(this)[_0xc23c63(0x126)]();_0xe84b4b=_0xe84b4b[_0xc23c63(0xbe)](/[\n\r]+/g,','),!_0x3f8e77[_0xc23c63(0x11e)](_0xe84b4b)&&(_0xe84b4b=_0xe84b4b[_0xc23c63(0xbe)](/[^0-9,\s,]/g,'')),$(this)[_0xc23c63(0x126)](_0xe84b4b);}),$(a0_0x2e4af2(0x10f))['on']('submit',async function(_0x56e121){const _0x37aa81=a0_0x2e4af2;_0x56e121[_0x37aa81(0xc6)](),$(_0x37aa81(0xf4))['empty'](),allData=[];let _0x30daa9=$('#documents')[_0x37aa81(0x126)]()[_0x37aa81(0x109)](',');_0x30daa9=_0x30daa9[_0x37aa81(0x116)](_0x4df3f6=>_0x4df3f6[_0x37aa81(0xdd)]()),_0x30daa9[_0x37aa81(0x112)]((_0x3b2354,_0x57d800)=>_0x3b2354-_0x57d800),_0x30daa9=[...new Set(_0x30daa9)],_0x30daa9=_0x30daa9[_0x37aa81(0xe3)](_0x49252d=>_0x49252d!==''&&_0x49252d['length']>0x0);if(_0x30daa9['length']===0x0){alert(_0x37aa81(0xff));return;}showSpinner();try{await Promise[_0x37aa81(0x108)](_0x30daa9[_0x37aa81(0x116)](_0x387def=>getDocument(_0x387def))),$(_0x37aa81(0x11b))[_0x37aa81(0xd5)](_0x37aa81(0x117)),hideSpinner();}catch(_0x446a15){console[_0x37aa81(0xd8)]('Error\x20al\x20procesar\x20los\x20documentos:',_0x446a15),hideSpinner();}}),$(a0_0x2e4af2(0xdf))['on']('click',function(){const _0x3d18cd=a0_0x2e4af2;if($(_0x3d18cd(0xf4))[_0x3d18cd(0xfd)]()[_0x3d18cd(0xfb)]===0x0){alert(_0x3d18cd(0xc1));return;}exportResultContainerToCSV('Resultado.csv');});const getToken=()=>{const _0x2a732f=a0_0x2e4af2;if(localStorage['getItem']('token'))return localStorage[_0x2a732f(0xc3)](_0x2a732f(0xef));$[_0x2a732f(0xf8)]({'url':hostLogin,'type':_0x2a732f(0x123),'contentType':'application/json','data':JSON[_0x2a732f(0xe9)](dataLogin),'success':function(_0x16de9e){const _0x4ce872=_0x2a732f,_0x555aaf=_0x16de9e[_0x4ce872(0xef)];return localStorage['setItem'](_0x4ce872(0xef),_0x555aaf),_0x555aaf;},'error':function(_0x45caab){const _0x28bb2c=_0x2a732f;return console[_0x28bb2c(0xd8)](_0x28bb2c(0x125),_0x45caab),null;}});},getParams=_0x40e4bb=>{const _0x54c7d9=a0_0x2e4af2;return encodeURIComponent(JSON[_0x54c7d9(0xe9)]({'Nombre':_0x54c7d9(0x105),'Descripcion':'SERVICIOS\x20PRESTADOS\x20A\x20PACIENTES','SentenciaSQL':'','Estado':_0x54c7d9(0xfa),'Parametros':[{'Nombre':_0x54c7d9(0xfe),'Campo':_0x54c7d9(0xd1),'Tipo':'String','DbNombre':'DOCUMENTO','DbNombreCompleto':_0x54c7d9(0x120),'DbTamano':0x1e,'DbTipo':'String','Valor':_0x40e4bb,'Oid':0x1,'IdBloqueo':null,'RegistroEliminado':![],'OidResult':null}],'formato':_0x54c7d9(0xca),'SerializadoXml':!![],'Oid':0x1a,'IdBloqueo':null,'RegistroEliminado':![],'OidResult':null}));},readExcelFromBlob=_0x37a102=>{const _0x1b5945=a0_0x2e4af2,_0x3f5ec2=new FileReader();_0x3f5ec2['onload']=function(_0x19c878){const _0x353ea2=a0_0x2d75,_0xcf2874=new Uint8Array(_0x19c878[_0x353ea2(0xf6)][_0x353ea2(0xd4)]),_0x1a1d90=XLSX['read'](_0xcf2874,{'type':_0x353ea2(0x118)}),_0x31e542=_0x1a1d90[_0x353ea2(0xea)][0x0],_0x1877c9=_0x1a1d90[_0x353ea2(0x10e)][_0x31e542],_0x405145=XLSX[_0x353ea2(0xd0)]['sheet_to_json'](_0x1877c9,{'header':0x1});_0x405145[_0x353ea2(0xcc)]((_0x37e172,_0x129a18)=>{const _0x35fb34=_0x353ea2;if(_0x129a18>0x0){let _0x350ebe=_0x37e172[0x1],_0x420285=_0x37e172[0x2]+'\x20'+_0x37e172[0x3]+'\x20'+_0x37e172[0x4]+'\x20'+_0x37e172[0x5],_0x118c5b=_0x37e172[0x6],_0x586013=_0x37e172[0x8],_0x51e5b3=_0x37e172[0x9],_0x5a6192=_0x37e172[0x14],_0x54a086=_0x37e172[0x15],_0x221d3d=excelDateToJSDate(_0x37e172[0x1e]);$(_0x35fb34(0xf4))[_0x35fb34(0x110)](_0x35fb34(0xc9)+_0x350ebe+',\x20'+_0x420285+',\x20'+_0x118c5b+',\x20'+_0x586013+',\x20'+_0x51e5b3+',\x20'+_0x5a6192+',\x20'+_0x54a086+',\x20'+excelDateToJSDate(_0x221d3d)+_0x35fb34(0x115));}});},_0x3f5ec2[_0x1b5945(0xfc)](_0x37a102);},excelDateToJSDate=_0x7b66cc=>{const _0x4e636d=a0_0x2e4af2,_0x193829=_0x7b66cc-0x63e1,_0x1b6540=_0x193829*0x15180,_0x304334=new Date(_0x1b6540*0x3e8),_0x38b122=String(_0x304334[_0x4e636d(0xdb)]())[_0x4e636d(0xd7)](0x2,'0'),_0x2ed0fe=String(_0x304334[_0x4e636d(0x114)]()+0x1)[_0x4e636d(0xd7)](0x2,'0'),_0x54c58f=_0x304334['getUTCFullYear']();return _0x38b122+'/'+_0x2ed0fe+'/'+_0x54c58f;},getDocument=_0x24bdbd=>{const _0x5dfc38=a0_0x2e4af2;return $(_0x5dfc38(0xf4))[_0x5dfc38(0xfd)]()[_0x5dfc38(0xfb)]===0x0&&$('#resultContainerDownloadDates')['append'](_0x5dfc38(0xf0)),new Promise(_0x578d4c=>{const _0x4770a7=_0x5dfc38;$[_0x4770a7(0xf8)]({'url':hostDocument,'type':_0x4770a7(0x10b),'headers':{'repparams':getParams(_0x24bdbd),'Authorization':_0x4770a7(0x121)+getToken()},'xhrFields':{'responseType':_0x4770a7(0xc5)},'success':function(_0x23f989){const _0x14867b=_0x4770a7,_0x2f9442=new FileReader();_0x2f9442['onload']=function(_0x18c8b2){const _0x194082=a0_0x2d75,_0x56d79f=new Uint8Array(_0x18c8b2[_0x194082(0xf6)][_0x194082(0xd4)]),_0x51d0f8=XLSX[_0x194082(0xf2)](_0x56d79f,{'type':_0x194082(0x118)}),_0xe31c9e=_0x51d0f8[_0x194082(0xea)][0x0],_0x26ebf9=_0x51d0f8[_0x194082(0x10e)][_0xe31c9e],_0x4f99d4=XLSX[_0x194082(0xd0)]['sheet_to_json'](_0x26ebf9,{'header':0x1});let _0x1605e9=![],_0x27ed7a=[];_0x4f99d4[_0x194082(0xcc)]((_0x5cb96a,_0x1787de)=>{const _0x1d575d=_0x194082;if(_0x1787de>0x0){const _0x17fe50=_0x5cb96a[0x1],_0x22a69f=replaceAccents(_0x5cb96a[0x2]+'\x20'+_0x5cb96a[0x3]+'\x20'+_0x5cb96a[0x4]+'\x20'+_0x5cb96a[0x5]),_0x24c97b=_0x5cb96a[0x6],_0x11f7b8=replaceAccents(_0x5cb96a[0x8]),_0x8502b8=replaceAccents(_0x5cb96a[0x9]),_0x41b3ee=_0x5cb96a[0x14],_0xa5fb56=replaceAccents(_0x5cb96a[0x15]),_0x44a255=excelDateToJSDate(_0x5cb96a[0x1e]);if(noImprimir[_0x1d575d(0xf1)](_0x327f3e=>_0xa5fb56['includes'](_0x327f3e['toUpperCase']())))return;if(!_0x17fe50){$('#resultContainerDownloadDates')[_0x1d575d(0x110)](_0x1d575d(0xc9)+_0x24bdbd+_0x1d575d(0x100)),_0x1605e9=!![];return;}!_0x27ed7a[_0x1d575d(0x106)](_0x41b3ee)&&$(_0x1d575d(0xf4))[_0x1d575d(0x110)](_0x1d575d(0xc9)+_0x17fe50+';\x20'+_0x22a69f+';\x20'+_0x24c97b+';\x20'+_0x11f7b8+';\x20'+_0x8502b8+';\x20'+_0x41b3ee+';\x20'+_0xa5fb56+';\x20'+_0x44a255+_0x1d575d(0x115)),_0x27ed7a[_0x1d575d(0x11c)](_0x41b3ee),_0x1605e9=!![];}}),!_0x1605e9&&$(_0x194082(0xf4))[_0x194082(0x110)](_0x194082(0xc9)+_0x24bdbd+';\x20sin\x20PM</p>');},_0x2f9442[_0x14867b(0xfc)](_0x23f989),_0x578d4c();},'error':function(_0x43043d){const _0x3775d1=_0x4770a7;console[_0x3775d1(0xd8)](_0x3775d1(0xf5),_0x43043d),_0x578d4c();}});});},exportResultContainerToCSV=_0xedf598=>{const _0x1ed30f=a0_0x2e4af2,_0x394e46=[];$('#resultContainerDownloadDates')['children']()[_0x1ed30f(0xde)](function(){const _0x4a8998=_0x1ed30f,_0x207129=$(this)[_0x4a8998(0x10d)]()[_0x4a8998(0xdd)]();_0x207129&&_0x394e46[_0x4a8998(0x11c)](_0x207129);});const _0x4c56b4=_0x394e46[_0x1ed30f(0xdc)]('\x0a'),_0x2def40=new Blob([_0x4c56b4],{'type':_0x1ed30f(0xf7)}),_0x439dcb=document[_0x1ed30f(0x102)]('a'),_0x4d5ffc=URL[_0x1ed30f(0xc4)](_0x2def40);_0x439dcb[_0x1ed30f(0x101)](_0x1ed30f(0xcf),_0x4d5ffc),_0x439dcb[_0x1ed30f(0x101)](_0x1ed30f(0xe6),_0xedf598+_0x1ed30f(0x10c)),_0x439dcb[_0x1ed30f(0x11d)][_0x1ed30f(0x119)]=_0x1ed30f(0xc0),document[_0x1ed30f(0xf3)][_0x1ed30f(0x107)](_0x439dcb),_0x439dcb['click'](),document[_0x1ed30f(0xf3)][_0x1ed30f(0xd9)](_0x439dcb);},replaceAccents=_0x4e88e6=>{const _0x1bf655=a0_0x2e4af2;if(!_0x4e88e6)return'';return _0x4e88e6[_0x1bf655(0xf9)](_0x1bf655(0xcb))[_0x1bf655(0xbe)](/[\u0300-\u036f]/g,'');},processDates=_0x147988=>{const _0x20451d=a0_0x2e4af2;return _0x147988[_0x20451d(0x116)](_0x47d304=>{const _0x11b91a=_0x20451d,_0x2c8f5b=_0x47d304['split']('/');if(_0x2c8f5b['length']!==0x3)return _0x11b91a(0xe2);let [_0x5c4f5a,_0x3cbf6c,_0xb7a606]=_0x2c8f5b[_0x11b91a(0x116)](_0x2bb14c=>parseInt(_0x2bb14c,0xa));if(_0x5c4f5a>0xc)return String(_0x5c4f5a)[_0x11b91a(0xd7)](0x2)+'/'+String(_0x3cbf6c)[_0x11b91a(0xd7)](0x2)+'/'+_0xb7a606;return String(_0x3cbf6c)[_0x11b91a(0xd7)](0x2)+'/'+String(_0x5c4f5a)['padStart'](0x2)+'/'+_0xb7a606;});};function a0_0x2d75(_0x528754,_0x15be89){const _0x3678e8=a0_0x3678();return a0_0x2d75=function(_0x2d75c7,_0x45f7a8){_0x2d75c7=_0x2d75c7-0xbe;let _0x36aa6f=_0x3678e8[_0x2d75c7];return _0x36aa6f;},a0_0x2d75(_0x528754,_0x15be89);}function a0_0x3678(){const _0xec0fd1=[';\x20sin\x20citas</p>','setAttribute','createElement','8082660jtcvOp','https://citas.usiese.gov.co:6007/api/HistoriaClinica/HistoriaClinicaConsulta/ObtenerHistoricoFolios/?oidIngreso=0&directivas=true&hcUnificada=false&id=','SERVICIOS\x20PRESTADOS\x20A\x20PACIENTES','includes','appendChild','all','split','.clean','GET','.csv','text','Sheets','#formDownloadDates','append','#spinner','sort','find','getUTCMonth','</p>','map','d-none','array','visibility','TRIAGE','#resultContainerDownloadDatesCard','push','style','test','4614669FjwmKr','@DOCUMENTO','Bearer\x20','parent','POST','#resultContainerFormatDatesCard','Error\x20al\x20obtener\x20el\x20token:','val','replace','#resultContainerFormatDates','hidden','No\x20hay\x20datos\x20para\x20descargar.','293872eALDNL','getItem','createObjectURL','blob','preventDefault','287IoKyaT','#documents','<p>','XLSX\x20PLANO','NFD','forEach','212hpJYXq','6sHvlZa','href','utils','GENPACIEN.PACNUMDOC\x20=','input','empty','result','removeClass','https://citas.usiese.gov.co:6007/api/Generales/ApiGeSeguridad/IniciarSesionCentroAtencion','padStart','error','removeChild','.results','getUTCDate','join','trim','each','#downloadCSV','#formFormatDates','addClass','Fecha\x20inválida','filter','URGENCIAS','ODONTOLOGIA\x20GENERAL','download','1158270NQEJWP','20649sZYGsc','stringify','SheetNames','CONSULTA\x20EXTERNA','42435730MpwwWc','click','113095nJgaTA','token','<p><b>PACNUMDOC;\x20NOMBRE;\x20SEXO;\x20EDAD_ACTUAL;\x20EDAD_SERVICIO;\x20SIPCODIGO;\x20SIPNOMBRE;\x20SERFECSER</b></p>','some','read','body','#resultContainerDownloadDates','Error\x20al\x20obtener\x20el\x20documento:','target','text/csv;charset=utf-8;','ajax','normalize','Activo','length','readAsArrayBuffer','children','DOCUMENTO','No\x20se\x20encontraron\x20documentos\x20válidos.'];a0_0x3678=function(){return _0xec0fd1;};return a0_0x3678();}$(a0_0x2e4af2(0xe0))['on']('submit',async function(_0x1b0aa6){const _0x39b490=a0_0x2e4af2;_0x1b0aa6['preventDefault'](),showSpinner(),$(_0x39b490(0xbf))[_0x39b490(0xd3)]();let _0x2cb09e=$('#dates')['val']()['replace'](/[\n\r]+/g,',')[_0x39b490(0x109)](',');_0x2cb09e=_0x2cb09e[_0x39b490(0x116)](_0x537059=>_0x537059[_0x39b490(0xdd)]()),_0x2cb09e=_0x2cb09e[_0x39b490(0xe3)](_0x223c52=>_0x223c52!=='');const _0x48f2a2=processDates(_0x2cb09e);_0x48f2a2['forEach'](_0x12d427=>{const _0x104255=_0x39b490;$(_0x104255(0xbf))['append'](_0x12d427+'</br>');}),$(_0x39b490(0x124))[_0x39b490(0xd5)](_0x39b490(0x117)),hideSpinner();});